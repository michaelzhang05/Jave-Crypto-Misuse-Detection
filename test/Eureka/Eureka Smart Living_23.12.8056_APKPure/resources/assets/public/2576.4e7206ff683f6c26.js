"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2576],{5485:(G,E,f)=>{f.d(E,{J:()=>F});var _=f(77144),h=f(41923),p=f(20361),S=f(8873),g=f(19462);class F{constructor(s){this.translate=s}GetAcModeName(s){switch(console.log(s,typeof s),s=Number(s)){case h.p.off:return"off";case h.p.heat:return"heat";case h.p.cool:return"cool";case h.p.auto:return"auto";case h.p.dry:return"dry";case h.p.fan:return"fan";default:return"off"}}AcModeIcon(s){switch(s){case h.p.off:return g.s.Images.ac_off;case h.p.heat:return g.s.Images.ac_heat;case h.p.cool:return g.s.Images.ac_cool;case h.p.auto:return g.s.Images.ac_auto;case h.p.dry:return g.s.Images.ac_dry;case h.p.fan:return g.s.Images.ac_fan;default:return g.s.Images.ac_mode}}GetFanModeName(s){switch(s=Number(s)){case p.E.off:return"off";case p.E.auto:return"auto";case p.E.low:return"low";case p.E.medium:return"medium";case p.E.high:return"high";default:return"off"}}FanModeIcon(s){switch(s){case p.E.off:return g.s.Images.fan_off;case p.E.auto:return g.s.Images.fan_auto;case p.E.low:return g.s.Images.fan_slow;case p.E.medium:return g.s.Images.fan_medium;case p.E.high:return g.s.Images.fan_high;default:return g.s.Images.fan_icon}}getListOfActionsByThing(s){console.log("GetListOfActions",s.actions);let n=[];for(let i=0;i<s.actions.length;i++){let o=s.actions[i];if(s.type==_.Y.RGB&&"SetValue"!=o.Name&&"TurnOn"!=o.Name&&"TurnOff"!=o.Name&&"SetWhite"!=o.Name&&"SetBrightness"!=o.Name&&"StartAnimation"!=o.Name&&"SetAnimationSpeed"!=o.Name&&"SetPowerState"!=o.Name)continue;console.log(o);let e={Name:o.Name,ThingType:s.is_device?1:2,DeviceType:s.type,Parameters:[]};if(s.type==_.Y.Thermostat){if("SetAcMode"==o.Name){let t=s.supported_ac_modes;if(t){let r=[];for(let l=0;l<t.length;l++)r.push({key:t[l],selected:0==l,value:this.GetAcModeName(t[l])});e.supported_ac_modes=r}}if("SetFanMode"==o.Name){let t=s.supported_fan_modes;if(t){let r=[];for(let l=0;l<t.length;l++)r.push({key:t[l],selected:0==l,value:this.GetFanModeName(t[l])});e.supported_fan_modes=r}}}else if(s.type==_.Y.MultiMedia){let t=s.SupportedSources,r=[];if(t){let m=t.split(",");for(let u=0;u<m.length;u++){let d=m[u].split("=");d.length<2||r.push(d[0])}e.Sources=r}e.Apps=s.Apps}let a=!0;if(o.Parameters){let t=Object.keys(o.Parameters);if(t&&s.type==_.Y.VirtualDevice){let r={Name:"",Type:"Nothing",Value:{}};if(console.log(o),o.Parameters.Button){r.Type="String";let l=this.getVirtualDeviceControls(s,2);r.ListOfActions=l,e.Parameters.push(r),n.push(e)}else if(o.Parameters.Slider){r.Type="String";let l=this.getVirtualDeviceControls(s,3);r.ListOfActions=l,r.Number=0,e.Parameters.push(r),n.push(e)}a=!1,console.log(e)}else if(t)for(let r=0;r<t.length;r++){let l=t[r];a=!1;let u={Name:l,Type:o.Parameters[l],Value:{}};"AcMode"==l&&e.supported_ac_modes&&e.supported_ac_modes.length>0?(u.Value=e.supported_ac_modes[0],u.Image=this.AcModeIcon(u.Value),u.AcValue=this.GetAcModeName(u.Value),console.log("setting default value of ac mode",u.Value)):"FanMode"==l&&e.supported_fan_modes&&e.supported_fan_modes.length>0&&(u.Value=e.supported_fan_modes[0],console.log("setting default value of fan mode",u.Value),u.AcValue=this.GetFanModeName(u.Value),u.Image=this.FanModeIcon(u.Value)),e.Parameters.push(u),n.push(e)}}a&&n.push(e)}return console.log(n),n}getVirtualDeviceControls(s,n=1){return s.device_ui.controls.filter(i=>-1==n||i.type==n)}getHTMLColor(s){let n=0,i=0,o=0;return n=(16711680&s)>>>16,i=(65280&s)>>>8,o=255&s,"rgb("+n+","+i+","+o+")"}getRGBValueFromNumber(s){let n=0,i=0,o=0,e=0;return e=(4278190080&s)>>>24,n=(16711680&s)>>>16,i=(65280&s)>>>8,o=255&s,this.get2DigitNumber((100+e/255*155).toString(16)),`${n},${i},${o}`}getHtmlRGBAFromNumber(s,n=0){let i=0,o=0,e=0,a=0;return a=(4278190080&s)>>>24,i=(16711680&s)>>>16,o=(65280&s)>>>8,e=255&s,this.get2DigitNumber((100+a/255*155).toString(16)),console.warn(n>0?`rgb(${i},${o},${e})`:`rgba(${i},${o},${e},${a+n})`),n>0?`rgb(${i},${o},${e})`:`rgba(${i},${o},${e},${a+n})`}get2DigitNumber(s){return("0"+s).slice(-2)}GetActionDescription(s,n,i=null){let o=S.a.DefaultController.devices.find(a=>a.id==s),e="";return e+=o.translated_name+" ",e+=this.translate.instant(n)+" ",o&&n&&(e+=this.GetFriendlyActionParameter(o,n,i)),console.log(e),e}GetFriendlyActionParameter(s,n,i=null){let o=i;if(s.type==_.Y.RGB){if(console.error(s,n,i),"SetValue"==n)return this.getHTMLColor(Number(i));if("StartAnimation"==n){let e=s,a=e.animations.find(t=>t.action==i);return console.error(e,a,n,"StartAnimation"),a?a.name:i}if("SetPowerState"==n)return this.translate.instant(this.getBooleanString(i,"on","off"));if("SetWhite"==n||"SetAnimationSpeed"==n)return i}else if(s.type==_.Y.Thermostat){if("SetSetTemperature"==n)return i+s.set_temperature_unit;if("SetAcMode"==n)return this.translate.instant(this.GetAcModeName(i));if("SetFanMode"==n)return this.translate.instant(this.GetFanModeName(i));if("SetPowerState"==n)return this.translate.instant(this.getBooleanString(i,"on","off"));if("SetPowerState"==n)return this.translate.instant(this.getBooleanString(i,"on","off"))}else if(s.type==_.Y.Switch){if(null!=i&&null!=i)return console.log(i),this.translate.instant("true"==i?"on":"off")}else if(i)return o=this.translate.instant(i),o;return""}getBooleanString(s,n,i){return s&&"true"==s.toString().toLowerCase()?this.translate.instant(n):this.translate.instant(i)}}},82576:(G,E,f)=>{f.d(E,{q:()=>i});var _=f(75128),h=f(1901),p=f(8873),S=f(17229),g=f(77144),F=f(5485),c=f(41923),s=f(20361),n=f(19462);class i{constructor(e){this.translate=e,this.sceneHelper=new _.U,this.file_conditions=[{selected:!0,value:0,name:this.translate.instant("exist")},{selected:!1,value:1,name:this.translate.instant("not-exist")}],this.thingUtility=new F.J(e)}UpdateOccupancyActionDescription(e){if(e.action.description=this.GetActionDescription(e.action),e.conditions)for(let a=0;a<e.conditions.length;a++){let t=e.conditions[a];t.description=this.GetConditionDescription(t)}}GetConditionDescription(e){let a="";switch(e.conditionType){case S.oS.ThingChanged:let t=p.a.DefaultController.things.find(m=>m.id==e.thingId&&m.thingType==e.thingType);t&&(a=this.getDeviceTagged(t.translated_name)+" "+(t.room?this.getRoomTagged(t.room.translated_name)+" ":"")+this.getPropertyTagged(this.translate.instant(e.property))+" "+this.getOperatorString(this.translate.instant(e.propertyOperator))+" "+(t.thingType==h.a.Device&&t.type==g.Y.RGB&&"Value"==e.property?this.getRGBColor(this.thingUtility.getHtmlRGBAFromNumber(e.propertyValue,1)):this.getValueTagged(this.GetFriendlyValue(t,e.property,e.propertyValue))));break;case S.oS.DateTime:a=this.getDateTimeConditionDescription(e,!0,[{selected:!0,value:1,name:"sunday"},{selected:!1,value:2,name:"monday"},{selected:!1,value:4,name:"tuesday"},{selected:!1,value:8,name:"wednesday"},{selected:!1,value:16,name:"thursday"},{selected:!1,value:32,name:"friday"},{selected:!1,value:64,name:"saturday"}]);break;case S.oS.GlobalVariableValue:a=this.getGlobalVariableConditionDescription(e);break;case S.oS.File:let l=this.file_conditions.find(m=>m.value==e.fileOperator);l&&(a="File "+l.name+": { "+e.fileName+" }")}return a}getGlobalVariableConditionDescription(e){let a=this.sceneHelper.GetTaggedValue(e.globalVariable,"span","device-tag")+" ",t=e.globalVariableOperator;return t=this.translate.instant(2==t?"less-than":1==t?"greater-than":"equals"),a+=this.getPropertyTagged(this.translate.instant(t))+" ",a+=this.getValueTagged(e.globalVariableValue),a}getOperatorString(e){return this.translate.instant(0==e?"equals":2==e?"less-than":1==e?"greater-than":"equals")}GetActionDescription(e){let a="",t=p.a.DefaultController.things.find(r=>r.id==e.thingId&&r.thingType==e.thingType);if(e.thingType==h.a.Device||e.thingType==h.a.Scene?t&&(a+=" "+this.getDeviceTagged(t.translated_name)+" "+this.getRoomTagged(t.room.translated_name)):e.thingType==h.a.Room&&t&&(a+=" "+this.getDeviceTagged(t.translated_name)),e.action)if(e.action&&(a+=this.getPropertyTagged(this.translate.instant(e.action))),"SetOccupancyState"==e.action){let r="";r=e.actionParameters?e.actionParameters.toString():"";let l=r.split(",");if(2==l.length){let m="true"==l[0].toLowerCase(),u="true"==l[1].toLowerCase();a+=this.translate.instant(u?"hold":" ")+" - "+this.translate.instant(m?"occupied":"unoccupied")}}else null!=e.actionParameters&&(a+=this.getValueTagged("("+(t.thingType==h.a.Device&&t.type==g.Y.RGB&&"Value"==e.actionParameters?this.getRGBColor(this.thingUtility.getHtmlRGBAFromNumber(e.actionParameters,1)):e.actionParameters)+")"));else e.property&&(a+=" "+this.getPropertyTagged(this.translate.instant(e.property)),a+=" "+this.getChangeOperatorString(e.propertyOperator),a+=" "+(t.thingType==h.a.Device&&t.type==g.Y.RGB&&"Value"==e.propertyValue?this.getRGBColor(this.thingUtility.getHtmlRGBAFromNumber(e.propertyValue,1)):this.getValueTagged(this.GetFriendlyValue(t,e.property,e.propertyValue))));if(e.delay>0){let r=new Date(0,0,0,0,0,e.delay),l=`${r.getHours()}:${r.getMinutes()}:${r.getSeconds()}`;a+=" "+this.translate.instant("delay")+"("+this.getActionTagged(this.translate.instant(l))+")"}e.revert>0&&(a+=" "+this.getPropertyTagged(this.translate.instant("revert")));try{e.ignoreMotionThreshold&&"0"!=e.ignoreMotionThreshold.toString()&&(a+=" "+this.translate.instant("ignore-motion")+" "+this.getNumberTagged(e.ignoreMotionThreshold)+"s")}catch{console.log("unable to parse ignore motion threshold")}return a}getChangeOperatorString(e){switch(e){case 2:return this.translate.instant("raise-to");case 3:return this.translate.instant("lower-to");default:return this.translate.instant("change-to")}}getDateTimeConditionDescription(e,a=!0,t=[]){let r="",l=0,m="";for(let T=0;T<t.length;T++){let y=t[T];(y.value&e.daysOfWeek)==y.value&&(0==l?(m+=" "+this.sceneHelper.GetTaggedValue(this.translate.instant(y.name),"span","number-tag"),this.translate.instant(y.name)):m+=this.sceneHelper.GetTaggedValue(" \u2022 "+this.translate.instant(y.name),"span","number-tag"),l+=1)}let u=new Date("2019-01-01 "+e.fromTime).getTime()-new Date("2019-01-01 "+e.toTime).getTime(),d=new Date(u),D=d.getUTCHours()+d.getUTCMinutes()+d.getUTCSeconds()<=1;if(l<7&&(r+=(a?this.translate.instant("only-if"):"")+" "+this.translate.instant("day-is")+m,D||(r+=" "+this.translate.instant("and")+" ")),!D){let T=this.translate.instant(["time","is","between"]);r+=(a?this.translate.instant("only-if"):"")+" "+T.time+" "+T.is+" "+T.between+" "+this.sceneHelper.GetTaggedValue(e.fromTime,"span","number-tag")+" "+this.translate.instant("and")+" "+this.sceneHelper.GetTaggedValue(e.toTime,"span","number-tag")}return r}GetFriendlyValue(e,a,t){if("Online"==a)return this.translate.instant(String(t));if("OccupancySensingEnabled"==a||"OccupancyState"==a||"ForceOccupancyState"==a||"ManualOccupancyState"==a)return this.translate.instant(this.translate.instant(t?"on":"off"));if(e.thingType==h.a.Device)switch(e.type){case g.Y.RGB:if("Animation"==a){let l=e.animations.find(m=>m.action==t);return l?l.name:t}return"AnimationSpeed"==a?t:"PowerState"==a?this.translate.instant(this.translate.instant(t?"on":"off")):this.getHTMLColor(t);case g.Y.Dimmer:if("Value"==a)return t+"%";break;case g.Y.RemoteControl:if("Value"==a)return t;break;case g.Y.Thermostat:if("SetTemperature"==a||"WarningOnLowTemperature"==a||"WarningOnHighTemperature"==a)return t+e.set_temperature_unit;if("SetRoomTemperature"==a)return t+e.room_temperature_unit;if("SetRoomHumidity"==a)return t+e.room_humidity_unit;if("SetAcMode"==a||"AcMode"==a)return this.translate.instant(this.sceneHelper.GetAcModeName(t));if("SetFanMode"==a||"FanMode"==a)return this.translate.instant(this.sceneHelper.GetFanModeName(t));if("FanState"==a)return this.translate.instant(this.sceneHelper.GetFanState(t));if("AcState"==a)return this.translate.instant(this.sceneHelper.GetAcState(t));if("Humidity"==a)return t+e.room_humidity_unit;if("PowerState"==a||"SetPowerState"==a)return this.translate.instant(this.translate.instant(t?"on":"off"));if("RoomTemperature"==a||"SetRoomTemperature"==a)return t+e.room_temperature_unit;break;case g.Y.Lock:return this.translate.instant(this.translate.instant(this.sceneHelper.getLockState(t)));case g.Y.Switch:return this.translate.instant(this.translate.instant(this.sceneHelper.getSwitchState(t)));case g.Y.TemperatureSensor:return t+e.unit;case g.Y.DoorSensor:return this.translate.instant(this.sceneHelper.getDoorState(t))}return e.type==g.Y.FloodSensor||e.type==g.Y.SmokeSensor||e.type==g.Y.MotionSensor?this.sceneHelper.getGeneralSensorValue(t):e.type==g.Y.LightSensor?t+e.unit?e.unit:"":e.type==g.Y.DoorBell?this.sceneHelper.getDoorBellStatus(t):e.type==g.Y.OccupancySensor?this.sceneHelper.getOccupancyStatus(t):e.type==g.Y.MultiMedia&&"MediaPlayerStatus"==a?e.getMediaPlayerStatusByEnum(t):t}GetAcStateName(e){switch(e=Number(e)){case c.p.off:return"off";case c.p.heat:return"heat";case c.p.cool:return"cool";case c.p.auto:return"auto";case c.p.dry:return"dry";case c.p.fan:return"fan";default:return"off"}}AcStateIcon(e){switch(e){case c.p.off:return n.s.Images.ac_off;case c.p.heat:return n.s.Images.ac_heat;case c.p.cool:return n.s.Images.ac_cool;case c.p.auto:return n.s.Images.ac_auto;case c.p.dry:return n.s.Images.ac_dry;case c.p.fan:return n.s.Images.ac_fan;default:return n.s.Images.ac_mode}}GetFanStateName(e){switch(e=Number(e)){case s.E.off:return"off";case s.E.auto:return"auto";case s.E.low:return"low";case s.E.medium:return"medium";case s.E.high:return"high";default:return"off"}}FanStateIcon(e){switch(e){case s.E.off:return n.s.Images.ac_off;case s.E.auto:return n.s.Images.ac_auto;case s.E.low:return n.s.Images.fan_slow;case s.E.medium:return n.s.Images.fan_medium;case s.E.high:return n.s.Images.fan_high;default:return n.s.Images.ac_fan}}getHTMLColor(e){let a=0,t=0,r=0,l=0;return a=(4278190080&e)>>>24,t=(16711680&e)>>>16,r=(65280&e)>>>8,l=255&e,"rgb("+t+","+r+","+l+")"}getRoomTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","room-tag")}getDeviceTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","device-tag")}getPropertyTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","property-tag")}getActionTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","action-tag")}getValueTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","value-tag")}getNumberTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","number-tag")}getTriggerTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","trigger-tag")}getGreenTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","green")}getPurpleTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","purple")}getColorTagged(e){return this.sceneHelper.GetTaggedValue(e,"span","color-tag")}getRGBColor(e){return`<span style="color:${e};">${e}</span>`}}}}]);