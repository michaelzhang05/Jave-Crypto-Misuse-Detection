"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6058],{96058:(U,N,l)=>{l.r(N),l.d(N,{NotificationListPageModule:()=>D});var u=l(96814),m=l(56223),s=l(73582),b=l(70160),p=l(15861),r=l(8873),C=l(51141),Z=l(31138),v=l(75886),i=l(65879),g=l(34414),x=l(63999),y=l(58646);function L(o,c){if(1&o){const e=i.EpF();i.TgZ(0,"ion-button",17),i.NdJ("click",function(){i.CHM(e);const t=i.oxw();return i.KtG(t.ShowAddNotificationPage())}),i._UZ(1,"ion-icon",18),i._uU(2),i.ALo(3,"translate"),i.qZA()}2&o&&(i.xp6(2),i.hij(" ",i.lcZ(3,1,"settings")," "))}function T(o,c){if(1&o&&i._UZ(0,"img",32),2&o){const e=i.oxw(2).$implicit;i.Q6J("src",null==e?null:e.image,i.LSH)}}function A(o,c){if(1&o&&i._UZ(0,"img",33),2&o){const e=i.oxw(2).$implicit;i.Q6J("src",null==e?null:e.image,i.LSH)}}function S(o,c){if(1&o&&(i.TgZ(0,"table"),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&o){const e=i.oxw(2).$implicit;i.xp6(1),i.AsE(" ",e.name," ",i.lcZ(2,2,e.getFriendlyActionName)," ")}}function P(o,c){if(1&o){const e=i.EpF();i.TgZ(0,"ion-grid",23)(1,"ion-row")(2,"ion-col",24),i.YNc(3,T,1,1,"img",25),i.YNc(4,A,1,1,"img",26),i.qZA(),i.TgZ(5,"ion-col",27),i.YNc(6,S,3,4,"table",28),i.qZA(),i.TgZ(7,"ion-col",29)(8,"ion-item",30)(9,"ion-checkbox",31),i.NdJ("ngModelChange",function(t){i.CHM(e);const a=i.oxw().$implicit;return i.KtG(a.active=t)})("ionChange",function(t){i.CHM(e);const a=i.oxw().$implicit;return i.KtG(a.toggle(t))}),i.qZA()()()()()}if(2&o){const e=i.oxw().$implicit,n=i.oxw(2);i.xp6(3),i.Q6J("ngIf",!n.notificationSettings.mobile_device_notification),i.xp6(1),i.Q6J("ngIf",n.notificationSettings.mobile_device_notification),i.xp6(2),i.Q6J("ngIf",e),i.xp6(3),i.Q6J("ngModel",e.active),i.uIk("disabled",!n.notificationSettings.mobile_device_notification)}}function k(o,c){if(1&o&&(i.TgZ(0,"div",20),i.YNc(1,P,10,5,"ion-grid",21),i._UZ(2,"div",22),i.qZA()),2&o){const e=c.$implicit;i.xp6(1),i.Q6J("ngIf",e)}}function w(o,c){if(1&o&&(i.TgZ(0,"div",6)(1,"ion-label",7),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.YNc(4,k,3,1,"div",19),i.qZA()),2&o){const e=c.$implicit;i.xp6(2),i.Oqu(i.lcZ(3,2,e.key)),i.xp6(2),i.Q6J("ngForOf",e.values)}}const M=[{path:"",component:(()=>{var o;class c{constructor(n,t,a,d,f,_,h){this.navCtrl=n,this.toastCtrl=t,this.translate=a,this.alertCtrl=d,this.platform=f,this.uuid=_,this.navParams=h,this.notificationSettings={page:"updateNotification",pageTitleKey:"notification",mobile_notification_id:-1,mobile_device_notification:!1,list_of_notification_devices_by_room:[]},this.isSuperUser=!1,this.unique_device_id="",this.theAppState=r.a,f.is("mobile")&&_.get().then(F=>{this.unique_device_id=F.identifier,console.log("unique_device_id",this.unique_device_id,"appstate",r.a.HardwareId)}),Z.B.showLoading2()}ionViewDidEnter(){var n=this;return(0,p.Z)(function*(){try{n.ionViewDidEnter2(),yield n.refresh(),n.getAllNotification()}catch(t){console.log(t)}finally{Z.B.dismissLoading2()}})()}ionViewDidEnter2(){console.log("ionViewDidEnter NotificationListPage"),this.isSuperUser=r.a.DefaultController.user.admin_level==v.Z.SuperUser||r.a.DefaultController.user.admin_level==v.Z.SystemAdmin||r.a.DefaultController.user.admin_level==v.Z.TechnicalSupport}getAllNotification(){if(r.a.DefaultController&&r.a.DefaultController.notifications&&r.a.DefaultController.notifications.length)for(let n=0;n<r.a.DefaultController.notifications.length;n++){let t=r.a.DefaultController.notifications[n],a=r.a.DefaultController.devices.find(d=>{var f;return null!=t&&d.id==(null===(f=t)||void 0===f?void 0:f.device_id)});a&&t?(a.room&&(t.room_name=a.room.translated_name),t.image=a.image_id.main_url,t.name=a.translated_name):(console.warn("no device found"),t=void 0)}this.notificationSettings.list_of_notification_devices_by_room=this.groupByArray(r.a.DefaultController.notifications,"room_name"),this.unique_device_id&&(console.info(this.unique_device_id),r.a.DefaultController.GetMobileDeviceForNotification(this.unique_device_id).then(n=>{this.notificationSettings.mobile_device_notification=n.ReceivePushNotification,this.notificationSettings.mobile_notification_id=n.Id}))}groupByArray(n,t){return n.reduce((a,d)=>{let f=t instanceof Function?t(d):d[t],_=a.find(h=>h&&h.key===f);return _?_.values.push(d):a.push({key:f,values:[d]}),a},[])}goBack(){this.navCtrl.back()}ShowAddNotificationPage(){this.navCtrl.navigateForward(C.F2)}toggleNotification(n){console.log(this.notificationSettings.mobile_notification_id,"this.notificationSettings.mobile_notification_id"),console.log(n.detail.checked,"toggle event  1"),r.a.DefaultController.SetMobileDeviceNotification(this.notificationSettings.mobile_notification_id,n.detail.checked).then(t=>{t&&console.log("notification set successfully..",t)},t=>{this.ErrorToast(t)}).catch(t=>{this.ErrorToast(t)})}refresh(){var n=this;return(0,p.Z)(function*(){console.log("refrehsing");try{(yield r.a.DefaultController.getUserDeivceNotifications())&&n.getAllNotification()}catch(t){n.ErrorToast(t)}})()}ErrorToast(n){this.ShowToast(n)}ShowToast(n){var t=this;return(0,p.Z)(function*(){(yield t.toastCtrl.create({message:n,duration:4e3})).present()})()}}return(o=c).\u0275fac=function(n){return new(n||o)(i.Y36(g.SH),i.Y36(g.yF),i.Y36(x.sK),i.Y36(g.Br),i.Y36(g.t4),i.Y36(y.i),i.Y36(g.X1))},o.\u0275cmp=i.Xpm({type:o,selectors:[["notification-list"]],decls:31,vars:14,consts:[["hideBackButton","true",2,"text-align","center","direction","ltr",3,"ngStyle"],[2,"padding","5px"],[2,"width","40px","float","left","display","block"],["tappable","","component-click","","tabindex","0",1,"top-mic-button",2,"font-size","30px","text-align","center","vertical-align","middle",3,"click"],["name","chevron-back"],["padding",""],[1,"button-container"],["stacked",""],[3,"name"],["size","9",2,"padding-top","18px"],["size","3"],[2,"direction","rtl","background","none","box-shadow","none"],["color","secondary",1,"setting-checkbox",2,"margin","0",3,"ngModel","ngModelChange","ionChange"],["size","12"],[2,"text-align","end","float","right","min-width","10px","width","100%"],["class","full-primary-button",3,"click",4,"ngIf"],["class","button-container",4,"ngFor","ngForOf"],[1,"full-primary-button",3,"click"],["name","create"],["class","event-item","ion-item","","style","padding-left:0px;",4,"ngFor","ngForOf"],["ion-item","",1,"event-item",2,"padding-left","0px"],["dir","ltr",4,"ngIf"],[1,"break-line-grad"],["dir","ltr"],["col-4",""],["style","width:60px; filter:grayscale(1)",3,"src",4,"ngIf"],["style","width:60px; filter:unset",3,"src",4,"ngIf"],["col-6","",2,"text-align","start","white-space","normal"],[4,"ngIf"],["col-2","",2,"text-align","end"],[2,"direction","rtl","background","none"],["color","calm",1,"setting-checkbox",2,"margin","0",3,"ngModel","ngModelChange","ionChange"],[2,"width","60px","filter","grayscale(1)",3,"src"],[2,"width","60px","filter","unset",3,"src"]],template:function(n,t){1&n&&(i.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"div")(3,"div",1)(4,"div",2)(5,"a",3),i.NdJ("click",function(){return t.goBack()}),i._UZ(6,"ion-icon",4),i.qZA()(),i.TgZ(7,"div")(8,"ion-title"),i._uU(9),i.ALo(10,"translate"),i.qZA()()()()()(),i.TgZ(11,"ion-content",5)(12,"ion-list")(13,"div",6)(14,"ion-label",7),i._uU(15),i.ALo(16,"translate"),i._UZ(17,"ion-icon",8),i.qZA(),i.TgZ(18,"ion-grid")(19,"ion-row")(20,"ion-col",9),i._uU(21),i.ALo(22,"translate"),i.qZA(),i.TgZ(23,"ion-col",10)(24,"ion-item",11)(25,"ion-checkbox",12),i.NdJ("ngModelChange",function(d){return t.notificationSettings.mobile_device_notification=d})("ionChange",function(d){return t.toggleNotification(d)}),i.qZA()()()(),i.TgZ(26,"ion-row")(27,"ion-col",13)(28,"div",14),i.YNc(29,L,4,3,"ion-button",15),i.qZA()()()()(),i.YNc(30,w,5,4,"div",16),i.qZA()()),2&n&&(i.xp6(1),i.Q6J("ngStyle",t.theAppState.iontoolbarStyle),i.xp6(8),i.Oqu(i.lcZ(10,8,"notifications")),i.xp6(6),i.hij("",i.lcZ(16,10,"push-notification")," "),i.xp6(2),i.Q6J("name",t.notificationSettings.mobile_device_notification?"notifications":"notifications-off"),i.xp6(4),i.hij(" ",i.lcZ(22,12,"receive-push-notification-on-this-device")," "),i.xp6(4),i.Q6J("ngModel",t.notificationSettings.mobile_device_notification),i.xp6(4),i.Q6J("ngIf",t.isSuperUser),i.xp6(1),i.Q6J("ngForOf",t.notificationSettings.list_of_notification_devices_by_room))},dependencies:[u.sg,u.O5,u.PC,m.JJ,m.On,s.YG,s.nz,s.wI,s.W2,s.jY,s.Gu,s.gu,s.Ie,s.Q$,s.q_,s.Nd,s.wd,s.sr,s.w,x.X$],styles:["ion-checkbox[_ngcontent-%COMP%]::part(container){border:1px solid gray;--size:30px}ion-checkbox[_ngcontent-%COMP%]{--size: 30px;--checkbox-background: var(--ion-color-light);--checkbox-background-checked: var(--ion-dark-theme-color);--checkmark-color: var(--ion-color-light);--border-style: 1px solid gray}"]}),c})()}];let J=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[b.Bz.forChild(M),b.Bz]}),c})(),D=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({providers:[y.i],imports:[u.ez,m.u5,s.Pc,J,x.aw.forChild()]}),c})()}}]);