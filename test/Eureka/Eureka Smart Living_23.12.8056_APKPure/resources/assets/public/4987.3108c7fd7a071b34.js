"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4987,9764],{14987:(Q,Y,f)=>{f.r(Y),f.d(Y,{Home2PageModule:()=>Re});var E=f(96814),R=f(56223),x=f(73582),J=f(70160),w=f(15861),Z=f(90274),C=f(46729),u=f(51141),h=f(77144),y=f(9952),S=f(37092),A=f(56544),c=f(8873),L=f(15231),O=f(19462),U=f(7110),G=f(43826),B=f(51140),V=f(210),e=f(65879),M=f(34414),q=f(88446),z=f(63999),K=f(77935),$=f(59764),j=f(69705);function W(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"a",19),e.NdJ("touchstart",function(o){e.CHM(i);const n=e.oxw();return e.KtG(n.longPressStart(o))})("touchend",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.PressEnd())}),e._UZ(1,"ion-icon",20),e.TgZ(2,"ion-badge",21),e._uU(3),e.qZA()()}if(2&a){const i=e.oxw();e.xp6(3),e.Oqu(i.speech_language_symbol)}}function X(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.ShowUILanguages())}),e._UZ(1,"img",23),e.qZA()}if(2&a){const i=e.oxw();e.xp6(1),e.Q6J("src",i.IMAGES.ui_language,e.LSH)}}function ee(a,p){if(1&a&&e._UZ(0,"breach-alert",24),2&a){const i=e.oxw();e.Q6J("id",i.getThingBreachIds)}}function te(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"ion-col",32)(1,"ion-searchbar",33),e.NdJ("ionInput",function(o){e.CHM(i);const n=e.oxw(2);return e.KtG(n.getItems(o))}),e.ALo(2,"translate"),e.qZA()()}2&a&&(e.xp6(1),e.s9C("placeholder",e.lcZ(2,1,"search")))}function oe(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(3);return e.KtG(o.toggle_editmode())}),e._UZ(1,"ion-icon",37),e.qZA()}}function ne(a,p){if(1&a&&(e.TgZ(0,"ion-col",34),e.YNc(1,oe,2,0,"button",35),e.qZA()),2&a){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!i.reorderSaveState)}}function ie(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(3);return e.KtG(o.add_room())}),e._UZ(1,"ion-icon",40),e.qZA()}}function re(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(3);return e.KtG(o.toggle_reorder())}),e._UZ(1,"ion-icon",41),e.qZA()}}function ae(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(3);return e.KtG(o.get_default_order())}),e._UZ(1,"ion-icon",42),e.qZA()}}function le(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(3);return e.KtG(o.save_reorder())}),e._UZ(1,"ion-icon",43),e.qZA()}}function se(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(3);return e.KtG(o.cancel_reorder())}),e._UZ(1,"ion-icon",44),e.qZA()}}function ce(a,p){if(1&a&&(e.TgZ(0,"ion-col",38)(1,"div",39)(2,"ion-buttons",16),e.YNc(3,ie,2,0,"button",35),e.YNc(4,re,2,0,"button",35),e.YNc(5,ae,2,0,"button",35),e.YNc(6,le,2,0,"button",35),e.YNc(7,se,2,0,"button",35),e.qZA()()()),2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("ngIf",i.editmode&&i.is_super_user),e.xp6(1),e.Q6J("ngIf",!i.reorderSaveState),e.xp6(1),e.Q6J("ngIf",i.reorderSaveState),e.xp6(1),e.Q6J("ngIf",i.reorderSaveState),e.xp6(1),e.Q6J("ngIf",i.editmode)}}function de(a,p){if(1&a&&(e.TgZ(0,"div",62),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const i=e.oxw(3).$implicit;e.xp6(1),e.AsE("",e.lcZ(2,2,"temperature"),": ",i.temp,"")}}function _e(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"ion-row",56),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.openRoom(o))}),e.TgZ(1,"ion-col",57)(2,"div",58)(3,"div",59)(4,"div",60),e._uU(5),e.qZA(),e._UZ(6,"div")(7,"div"),e.YNc(8,de,3,4,"div",61),e.qZA()()()()}if(2&a){const i=e.oxw(2).$implicit;e.xp6(5),e.Oqu(i.translated_name),e.xp6(3),e.Q6J("ngIf",i.have_temp)}}function ue(a,p){if(1&a&&(e.TgZ(0,"ion-select-option",67),e._uU(1),e.qZA()),2&a){const i=p.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(i.name)}}function ge(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"ion-button",73),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(3).$implicit,n=e.oxw(2);return e.KtG(n.DeleteRoom(o))}),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"ion-icon",74),e.qZA()}2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"delete ")," "))}function me(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"ion-row",58)(1,"ion-col",57)(2,"div",58)(3,"div",59)(4,"div",63)(5,"ion-input",64),e.NdJ("ngModelChange",function(o){e.CHM(i);const n=e.oxw(2).$implicit;return e.KtG(n.name=o)})("ionBlur",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.SaveRoomInformation(o))}),e.qZA()(),e.TgZ(6,"div",65)(7,"ion-select",66),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(4);return e.KtG(o.scrollToSelected())})("ngModelChange",function(o){e.CHM(i);const n=e.oxw(2).$implicit;return e.KtG(n.parent_id=o)})("ionChange",function(o){e.CHM(i);const n=e.oxw(2).$implicit,r=e.oxw(2);return e.KtG(r.onSelectChange(o,n))}),e.ALo(8,"translate"),e.ALo(9,"translate"),e.TgZ(10,"ion-select-option",67),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.YNc(13,ue,2,2,"ion-select-option",68),e.qZA()(),e.TgZ(14,"div",69)(15,"ion-button",70),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.selectImage(o))}),e._uU(16),e.ALo(17,"translate"),e._UZ(18,"ion-icon",71),e.qZA(),e.YNc(19,ge,4,3,"ion-button",72),e.qZA()()()()()}if(2&a){const i=e.oxw(2).$implicit,t=e.oxw(2);e.xp6(5),e.Q6J("ngModel",i.name),e.xp6(2),e.Q6J("label",0==i.parent_id?e.lcZ(8,8,"room-is-child-of"):e.lcZ(9,10,"assign-parent-room"))("ngModel",i.parent_id),e.xp6(3),e.Q6J("value",-1),e.xp6(1),e.Oqu(e.lcZ(12,12,"none")),e.xp6(2),e.Q6J("ngForOf",t.list_of_rooms),e.xp6(3),e.hij(" ",e.lcZ(17,14,"Background ")," "),e.xp6(3),e.Q6J("ngIf",t.isExperimentEnabled)}}function pe(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"div",75)(1,"div",76),e._UZ(2,"img",77),e.TgZ(3,"span",78),e._uU(4),e.qZA()(),e.TgZ(5,"div",76),e._UZ(6,"img",77),e.TgZ(7,"span",79),e._uU(8),e.qZA()(),e.TgZ(9,"div",80),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.showOccupancyDialog(o))}),e._UZ(10,"img",81),e.TgZ(11,"span",82),e._uU(12),e.qZA()(),e.TgZ(13,"div",76),e._UZ(14,"img",81),e.TgZ(15,"span",83),e._uU(16),e.qZA()()()}if(2&a){const i=e.oxw(2).$implicit,t=e.oxw(2);e.xp6(1),e.Tol(i.have_msensor?"":"inactive"),e.xp6(1),e.Q6J("src",i.is_msensor_active?t.IMAGES.motion.active:t.IMAGES.motion.idle,e.LSH),e.xp6(2),e.Oqu(i.sensor_breached_time_string),e.xp6(1),e.Tol(i.have_door?"":"inactive"),e.xp6(1),e.Q6J("src",i.is_door_open?t.IMAGES.door_open_icon:t.IMAGES.door_close_icon,e.LSH),e.xp6(2),e.Oqu(i.door_breached_time_string),e.xp6(1),e.Tol(null!=i.OccupancyState?"":"inactive"),e.xp6(1),e.Udp("background-image",i.ForceOccupancyState?"url("+t.IMAGES.forced_occupancy+")":i.ManualOccupancyState?"url("+t.IMAGES.manual_occupancy+")":""),e.Q6J("src",i.OccupancyState?t.IMAGES.occupied:t.IMAGES.unoccupied,e.LSH),e.xp6(2),e.Oqu(i.OccupancyDT),e.xp6(1),e.Tol(i.have_temp?"":"inactive"),e.xp6(1),e.Q6J("src",t.IMAGES.thermometer_icon,e.LSH),e.xp6(2),e.Oqu(i.temp)}}function fe(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"ion-button",84),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.toggleLights(o))}),e._UZ(1,"img",85),e.qZA()}if(2&a){const i=e.oxw(2).$implicit,t=e.oxw(2);e.Tol(i.have_lights?"":" inactive"),e.ekj("active",i.is_lights_on),e.xp6(1),e.Q6J("src",i.is_lights_on?t.IMAGES.light._100:t.IMAGES.light._10,e.LSH)}}function he(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"ion-button",84),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.toggleAC(o))}),e._UZ(1,"img",85),e.qZA()}if(2&a){const i=e.oxw(2).$implicit,t=e.oxw(2);e.Tol(i.have_ac?"":" inactive"),e.ekj("active",i.is_ac_on),e.xp6(1),e.Q6J("src",i.is_ac_on?t.IMAGES.thermostat_state.on:t.IMAGES.thermostat_state.off,e.LSH)}}function ve(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"ion-button",84),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.toggleCurtains(o))}),e._UZ(1,"img",85),e.qZA()}if(2&a){const i=e.oxw(2).$implicit,t=e.oxw(2);e.Tol(i.have_curtain?"":" inactive"),e.ekj("active",i.is_curtains_open),e.xp6(1),e.Q6J("src",i.is_curtains_open?t.IMAGES.shutter._100:t.IMAGES.shutter._0,e.LSH)}}function be(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"ion-button",84),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.toggleFans(o))}),e._UZ(1,"img",85),e.qZA()}if(2&a){const i=e.oxw(2).$implicit,t=e.oxw(2);e.Tol(i.have_fan?"":" inactive"),e.ekj("active",i.is_fan_on),e.xp6(1),e.Q6J("src",i.is_fan_on?t.IMAGES.fan_on_icon:t.IMAGES.fan_off_icon,e.LSH)}}function xe(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"div",86)(1,"button",87),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.moveItemUp(o))}),e._UZ(2,"ion-icon",88),e.qZA(),e.TgZ(3,"button",89),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2).$implicit,n=e.oxw(2);return e.KtG(n.moveItemDown(o))}),e._UZ(4,"ion-icon",90),e.qZA()()}}function Ce(a,p){if(1&a&&(e.TgZ(0,"ion-card",47,48)(2,"ion-grid",49),e.YNc(3,_e,9,2,"ion-row",50),e.YNc(4,me,20,16,"ion-row",51),e.YNc(5,pe,17,18,"div",52),e.qZA(),e.TgZ(6,"ion-footer")(7,"ion-toolbar",53)(8,"ion-buttons",11),e.YNc(9,fe,2,5,"ion-button",54),e.YNc(10,he,2,5,"ion-button",54),e.YNc(11,ve,2,5,"ion-button",54),e.YNc(12,be,2,5,"ion-button",54),e.qZA()()(),e.YNc(13,xe,5,0,"div",55),e.qZA()),2&a){const i=e.oxw().$implicit,t=e.oxw(2);e.Akn("margin:15px 10px 15px 10px;"+t.getRoomStyle(i)),e.xp6(3),e.Q6J("ngIf",!t.editmode),e.xp6(1),e.Q6J("ngIf",t.editmode),e.xp6(1),e.Q6J("ngIf",!t.editmode),e.xp6(4),e.Q6J("ngIf",!t.editmode&&i.have_lights),e.xp6(1),e.Q6J("ngIf",!t.editmode&&i.have_ac),e.xp6(1),e.Q6J("ngIf",!t.editmode&&i.have_curtain),e.xp6(1),e.Q6J("ngIf",!t.editmode&&i.have_fan),e.xp6(1),e.Q6J("ngIf",t.reorderSaveState&&t.editmode)}}function we(a,p){if(1&a&&(e.TgZ(0,"ion-reorder",45),e.YNc(1,Ce,14,10,"ion-card",46),e.qZA()),2&a){const i=p.$implicit;e.Q6J("key",i.id),e.xp6(1),e.Q6J("ngIf",i)}}function ye(a,p){if(1&a){const i=e.EpF();e.TgZ(0,"ion-content",25)(1,"ion-header")(2,"ion-toolbar")(3,"ion-grid",26)(4,"ion-row"),e.YNc(5,te,3,3,"ion-col",27),e.YNc(6,ne,2,1,"ion-col",28),e.YNc(7,ce,8,5,"ion-col",29),e.qZA()()()(),e.TgZ(8,"ion-list")(9,"ion-reorder-group",30),e.NdJ("ionItemReorder",function(o){e.CHM(i);const n=e.oxw();return e.KtG(n.reorderItemsEvent(o))}),e.YNc(10,we,2,2,"ion-reorder",31),e.qZA()()()}if(2&a){const i=e.oxw();e.xp6(5),e.Q6J("ngIf",!i.editmode),e.xp6(1),e.Q6J("ngIf",!i.editmode),e.xp6(1),e.Q6J("ngIf",i.editmode),e.xp6(2),e.Q6J("disabled",i.disable_hand),e.xp6(1),e.Q6J("ngForOf",i.addedRooms)}}const ke=[{path:"",component:(()=>{var a;class p extends A.n{get hideUILanguage(){return c.a.StaticSettings.HideUILanguage}encodeUrlPath(t){let[o,n]=t.split("://");return n?(n=n.split("/").map(r=>encodeURIComponent(r)).join("/").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/'/g,"%27").replace(/"/g,"%22").replace(/,/g,"%2C"),`${o}://${n}`):(n=t.split("/").map(r=>encodeURIComponent(r)).join("/").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/'/g,"%27").replace(/"/g,"%22").replace(/,/g,"%2C"),n||(console.error("Invalid URL format. URL must include a protocol and path."),t))}getRoomStyle(t){let o="",n="";return n="filter:grayscale(0);",o=t&&t.image_id&&t.image_url?t.image_id<72||-1==t.image_url.indexOf("Resources/Images/Custom/")?`background:url('${this.encodeUrlPath(t.image_url)}') no-repeat center center; background-size: contain;`:`background:url('${this.encodeUrlPath(t.image_url)}') no-repeat center center;background-size: cover;`:`background:url('${O.s.Images.default_room_image}') no-repeat center center;background-size: contain;`,o+="filter:grayscale(0);",o}saveData(){this.editmode=!1,this.enable_reorder=!1}selectImage(t){var o=this;return(0,w.Z)(function*(){const n=yield o.modalCtrl.create({component:U.R,componentProps:{index:t.image_id,filter:"user"},backdropDismiss:!1});yield n.present();const{data:r}=yield n.onDidDismiss();r&&r.id&&(t.image_id=r.id,t.image_url=r.url,yield o.SaveRoomInformation(t))})()}CreateRoom(){var t=this;return(0,w.Z)(function*(){let o=new V.A;const n=t.listOfRooms.reduce((d,k)=>k.id>d?k.id:d,-1/0);o.Name="New Room "+(n+1),o.Visible=1;let s=t.roomHelper.getRoomSavingEntity(o);s.uiDataTranslationEntities=[];let g=yield t.loadingCtrl.create({backdropDismiss:!0,showBackdrop:!0});g.present(),c.a.DefaultController.SaveRoomEntity("create",s).then(d=>{let k=d.body.roomEntity;c.a.DefaultController.LoadAllRooms().then(P=>{c.a.DefaultController.LoadAllDevices().then(T=>{t.showToast("Room Created");let F=c.a.DefaultController.rooms.find(D=>D.id===k.id);t.addedRooms.push(F),t.refreshElement()})})}).catch(d=>{t.showToast("Unable To Create Room"),console.error("Unable to Create Room",d)}),g&&""!=g.innerHTML&&g.dismiss()})()}DeleteRoom(t){var o=this;return(0,w.Z)(function*(){var r;(yield o.alertCtrl.create({header:o.translate.instant("delete"),cssClass:"network-alert",message:o.translate.instant("are-you-sure-you-want-to-delete"),buttons:[{text:o.translate.instant("yes"),role:"null",handler:(r=(0,w.Z)(function*(){if(t&&t.id){let l=yield o.loadingCtrl.create({backdropDismiss:!0,showBackdrop:!0});l.present(),c.a.DefaultController.DeleteRoomEntity(t.id).then(s=>{c.a.DefaultController.LoadAllRooms().then(g=>{c.a.DefaultController.LoadAllDevices().then(d=>{l&&""!=l.innerHTML&&l.dismiss();let k=o.addedRooms.indexOf(t);o.addedRooms.splice(k,1),o.showToast("Room Deleted")})})})}}),function(){return r.apply(this,arguments)})},{text:o.translate.instant("no"),role:"cancel",handler:()=>{}}]})).present()})()}SaveRoomInformation(t){var o=this;return(0,w.Z)(function*(){let n=c.a.DefaultController.rooms.find(l=>l.id===t.id);n.image_id=t.image_id,n.name=t.name,n.parent_id=t.parent_id;let r=o.addedRooms.find(l=>l.id===t.id);r.name!=n.name&&(r.name=t.name),yield c.a.DefaultController.LoadAllRoomEntityDTO(t.id).then(l=>{let s=l;s.roomEntity.name=t.name,s.roomEntity.parentId=t.parent_id,s.roomEntity.imageId=t.image_id,c.a.DefaultController.SaveRoomEntity("update",s,t.id).then(d=>{c.a.DefaultController.LoadAllRooms().then(k=>{c.a.DefaultController.LoadAllDevices().then(P=>{o.showToast("Room Information Saved")})})}).catch(d=>{console.error("Unable to Save",d)})}).catch(l=>{console.error("Unable to LoadAllRoomEntityDTO",l)})})()}changeEdit(){}updatestatetest2(t){this.updateRoomsLink()}updateRoomsLink(){var t=this;return(0,w.Z)(function*(){if(t.listOfRooms)for(let o=0;o<t.listOfRooms.length;o++){let n=c.a.DefaultController.rooms.find(r=>r.id===t.listOfRooms[o].id);t.listOfRooms[o]=n}})()}updatestatetest(t){this.updateRoomInfo(t)}toggleDoors(t){throw new Error("Method not implemented.")}constructor(t,o,n,r,l,s,g,d,k,P,T,F,D,N,H){if(super(o,s,n,l,t,g,!1,D,P,k),this.navCtrl=t,this.alertController=n,this.navProvider=r,this.platform=s,this.popoverCtrl=d,this.loadingCtrl=T,this.navParams=F,this.router=D,this.changeDetector=N,this.modalCtrl=H,this.is_super_user=!1,this.imageDescription="",this.editmode=!1,this.IMAGES=O.s.Images,this.next_type="device",this.filter="",this._temp_update_timer2=-1,this.delay_update=!1,this.delay_update_timeout=-1,this.enable_reorder=!1,this.theAppState=c.a,this.toggleLightsForRoom=(v,_)=>{for(let b=0;b<v.children_rooms.length;b++)this.toggleLightsForRoom(v.children_rooms[b],_);console.log("toggle lights for room",v.name),this.delay_update=!0;let I=_;for(let b=0;b<v.devices.length;b++){let m=v.devices[b];m.permission_readonly||m.ExcludeFromRoomControl||m.category==y.I.Lighting&&(m.type==h.Y.Switch||m.type==h.Y.Dimmer||m.type==h.Y.RGB)&&m.turnState(I)}},this.toggleCurtainsForRoom=(v,_)=>{for(let b=0;b<v.children_rooms.length;b++)this.toggleCurtainsForRoom(v.children_rooms[b],_);this.delay_update=!0;let I=_;for(let b=0;b<v.devices.length;b++){let m=v.devices[b];m.permission_readonly||m.category==y.I.Curtains&&m.type==h.Y.Shutter&&(I?m.turnOn():m.turnOff())}},this.toggleFansForRoom=(v,_)=>{for(let b=0;b<v.children_rooms.length;b++)this.toggleFansForRoom(v.children_rooms[b],_);console.log("toggle fans for room",v.name),this.delay_update=!0;let I=_;for(let b=0;b<v.devices.length;b++){let m=v.devices[b];m.permission_readonly||m.ExcludeFromRoomControl||m.category==y.I.Fan&&(m.type==h.Y.Switch||m.type==h.Y.Dimmer)&&m.turnState(I)}},this.toggleACForRoom=(v,_)=>{console.log("Toggle AC for room",v.name);for(let b=0;b<v.children_rooms.length;b++)this.toggleACForRoom(v.children_rooms[b],_);this.delay_update=!0;let I=_;for(let b=0;b<v.devices.length;b++){let m=v.devices[b];m.permission_readonly||m.category==y.I.HVAC&&m.type==h.Y.Thermostat&&(1==I?m.turnOn():0==I&&m.turnOff())}},this.isTabletDevice=!1,this.longPressCounter=0,this.longPressDetected=!1,this.yScrollDt=0,this.reorderRoomsIds=[],this.reorderSaveState=!1,this.disable_hand=!0,this.list_of_rooms=[],this.currentLangauge="en",this.isHomePage=!0,this._screen=screen,c.a.DefaultController&&c.a.DefaultController.user&&(this.is_super_user=c.a.DefaultController.user.is_super_user),this.roomHelper=new B.J,D.getCurrentNavigation().extras.state){const v=this.router.getCurrentNavigation().extras.state;if(console.log(v," params"),null!=v.data){let _=this.navParams.get("filter");null==_||null==_||(this.filter=_)}}this.InitializeAllRooms()}_delay4sUpdate(){this.refreshAllRooms()}buildHierarchy(t,o){return function n(l,s){let g=[];return l.forEach(d=>{d.roomLevel<=s&&(g.push(d),g=g.concat(n(d.children_rooms,s)))}),g}(t.filter(l=>0===l.roomLevel),o)}InitializeAllRooms(){var t=this;return(0,w.Z)(function*(){if(console.time("initializeAllRooms"),t.addedRooms=[],null!=c.a.DefaultController&&null!=c.a.DefaultController.rooms){const o=t.buildHierarchy(c.a.DefaultController.rooms,c.a.roomLevel);if(console.log(o),t.addedRooms=o,t.addedRooms&&t.addedRooms.length)for(let n=0;n<t.addedRooms.length;n++)t.addedRooms[n].updateTranslatedName();t.listOfRooms=t.addedRooms}else t.navCtrl.navigateRoot(u.g6,{animationDirection:"forward"});console.timeEnd("initializeAllRooms")})()}get AppIcon(){return S.Y.getAppLogo}ionViewDidLeave(){window.onpopstate=null,super.ionViewDidLeave(),C.V0.events.unsubscribe(G.n.UI_LANGUAGE_CHANGED,this.uiLangaugeChangeHandler),this.uiLangaugeChangeHandler&&(this.uiLangaugeChangeHandler=void 0),this._delay4sUpdate&&(C.V0.events.unsubscribe(L.B.DeviceUpdate,this._delay4sUpdate),this._delay4sUpdate=void 0),clearInterval(this._temp_update_timer2),clearTimeout(this.delay_update_timeout)}updateTimer(){for(let t=0;t<this.addedRooms.length;t++){let o=this.addedRooms[t];o.have_door&&(o.door_breached_time_string=C.V0.getElapsedDateTime(new Date(o.door_breached_time),this.translate.currentLang,!1)),o.have_msensor&&(o.sensor_breached_time_string=C.V0.getElapsedDateTime(new Date(o.sensor_breached_time),this.translate.currentLang,!1));let n=1==o.OccupancyState?o.OccupiedSince:o.UnoccupiedSince;n&&(o.OccupancyDT=C.V0.getElapsedDateTime(new Date(n),this.translate.currentLang,!1))}}updateRoomInfo(t){var o=this;return(0,w.Z)(function*(){yield o._updateRoomInfo(t)})()}_updateRoomInfo(t){t.is_ac_locked=!1,t.have_temp=!1,t.have_door=!1,t.is_door_open=!1,t.have_msensor=!1,t.have_humidity=!1,t.is_lights_locked=!1,t.is_curtains_locked=!1,t.is_msensor_active=!1,t.lights_value=0,t.curtains_value=0,t.door_breached_time=0,t.sensor_breached_time=0,t.temp=" ",t.humidity=" ",t.door_breached_time_string="",t.sensor_breached_time_string="";let o=1==t.OccupancyState?t.OccupiedSince:t.UnoccupiedSince;o&&(t.OccupancyDT=C.V0.getElapsedDateTime(new Date(o),this.translate.currentLang,!1));let n=0,r=0,l=!1,s=new Date(1971,1,1).valueOf(),g=!1,d=new Date(1971,1,1).valueOf(),k=this.getRoomAllDevices(t);for(let P=0;P<k.length;P++){let T=k[P];if(T.online&&T.visible&&T.enabled)switch(T.type){case h.Y.DoorSensor:let F=T;t.have_door=!0;let D=T;if(l=l||F.IsOn,l){let _=Date.parse(D.LastBreached.toString());s<_&&(s=_,t.door_breached_time=_)}else{let _=Date.parse(D.LastClosed.toString());s<_&&(s=_,t.door_breached_time=_)}break;case h.Y.MotionSensor:t.have_msensor=!0,g=g||T.IsOn;let N=T;if(g&&N.LastBreached){let _=N.LastBreached.valueOf();d<_&&(t.sensor_breached_time=_,d=_)}else if(N.LastInactive){let _=N.LastInactive.valueOf();d<_&&(t.sensor_breached_time=_,d=_)}break;case h.Y.HumiditySensor:t.have_humidity=!0,t.humidity=T.value+"%";break;case h.Y.TemperatureSensor:if(T.visible&&T.enabled&&T.online){let _=this.convertTempToC(T.properties.Value,T.properties.unit);null!=_&&!Number.isNaN(_)&&0!=_&&(n+=_,r+=1),t.have_temp=!0}break;case h.Y.Thermostat:if(T.visible&&T.enabled&&T.online){let _=this.convertTempToC(T.RoomTemperature,T.room_temperature_unit);null!=_&&0!=_&&(n+=_,r+=1),t.have_temp=!0}}}return t.is_msensor_active=g,t.have_msensor&&(t.sensor_breached_time=d,t.sensor_breached_time_string=C.V0.getElapsedDateTime(new Date(t.sensor_breached_time),this.translate.currentLang,!1)),t.is_door_open=l,t.door_breached_time_string=C.V0.getElapsedDateTime(t.door_breached_time,this.translate.currentLang,!1),t.is_lights_locked=t.is_lights_locked&&t.have_lights,t.is_ac_locked=t.is_ac_locked&&t.have_ac,t.is_curtains_locked=t.is_curtains_locked&&t.have_curtain,r>0&&(t.temp=0!=n?(n/r).toFixed(0)+"\xb0C":"---\xb0C"),t}convertTempToC(t,o="C"){if(o=o.toLowerCase(),t=Number(t),!Number.isNaN(t))return"k"==o?t-273.15:"f"==o?.5555*(t-32):t}findExisitingRoom(t,o){let n=!1;for(let r=0;r<t.length;r++)if(t[r]===o){n=!0;break}return n}toggle(t,o,n,r,l,s,g=!0){var d=this;return(0,w.Z)(function*(){g&&t.children_rooms.length>0?(yield d.alertCtrl.create({header:o,message:n,cssClass:"network-alert",buttons:[{text:d.translate.instant(r),handler:()=>{s(t,l)}},{text:d.translate.instant("cancel"),role:"cancel",handler:()=>{}}]})).present():s(t,l)})()}toggleLights(t,o=!0){var n=this;return(0,w.Z)(function*(){if(n.editmode)return;let r=n.translate.instant(t.is_lights_on?"turn-off-all-light":"turn-on-all-light"),l=n.translate.instant(t.is_lights_on?"TurnOff":"TurnOn");n.toggle(t,t.name,r,l,!t.is_lights_on,n.toggleLightsForRoom,o),window.setTimeout(()=>{n.refreshAllRooms()},2e3)})()}toggleAC(t,o=!0){if(this.editmode)return;let n=this.translate.instant(t.is_ac_on?"turn-off-all-acs":"turn-on-all-acs"),r=this.translate.instant(t.is_ac_on?"TurnOff":"TurnOn");this.toggle(t,t.name,n,r,!t.is_ac_on,this.toggleACForRoom,o),window.setTimeout(()=>{this.refreshAllRooms()},2e3)}toggleCurtains(t,o=!0){if(this.editmode)return;let n=this.translate.instant(t.is_curtains_open?"close-all-curtains":"open-all-curtains"),r=this.translate.instant(t.is_curtains_open?"close":"open");this.toggle(t,t.name,n,r,!t.is_curtains_open,this.toggleCurtainsForRoom,o),window.setTimeout(()=>{this.refreshAllRooms()},2e3)}toggleFans(t,o=!0){if(this.editmode)return;let n=this.translate.instant(t.is_fan_on?"close-all-fans":"open-all-fans"),r=this.translate.instant(t.is_fan_on?"TurnOff":"TurnOn");this.toggle(t,t.name,n,r,!t.is_fan_on,this.toggleFansForRoom,o),window.setTimeout(()=>{this.refreshAllRooms()},2e3)}getRoomAllDevices(t,o=void 0){let n=t.devices.filter(r=>!r.ExcludeFromRoomControl&&(null==o||null!=o&&r.type!=o));for(let r=0;r<t.children_rooms.length;r++)n=n.concat(this.getRoomAllDevices(t.children_rooms[r],h.Y.DoorSensor));return n}refreshAllRooms(){this.updateRoomsLink().then(t=>{if(this.addedRooms&&this.addedRooms.length)for(let o=0;o<this.addedRooms.length;o++)this.updateRoomInfo(this.addedRooms[o])})}InitializeHomeScreen(){0!=c.a.appFlow?c.a.WentFromHome=!0:this.navCtrl.navigateRoot(c.a.mainPage)}openRoom(t){var o=this;return(0,w.Z)(function*(){let n=yield o.loadingCtrl.create({backdropDismiss:!1,spinner:"crescent"});n.present().then(r=>{console.log("Opening Room....",o.filter),""!=o.filter&&null!=o.filter&&null!=o.filter?o.navCtrl.navigateForward(u.Ak,{state:{data:{room:t,filter:o.filter}}}).then(l=>{n.dismiss()}):"device"===o.next_type&&o.navCtrl.navigateForward(u.Ak,{state:{data:{room:t}}}).then(l=>{n.dismiss()})})})()}ionViewDidEnter(){var t=()=>super.ionViewDidEnter,o=this;return(0,w.Z)(function*(){t().call(o),console.log("ionViewDidEnter Home2"),o.IMAGES=O.s.Images,c.a&&c.a.AppFunctionality&&c.a.AppFunctionality.RegisterDefaultBackButton(),o.isTabletDevice=screen.width>screen.height,1==c.a.refreshHomePage&&(o.InitializeHomeScreen(),c.a.refreshHomePage=!1),o.InitializeAllRooms(),clearInterval(o._temp_update_timer2),o._temp_update_timer2=window.setInterval(()=>{o.updateTimer()},1e3),o._delay4sUpdate=()=>{console.log("delay 4s update"),o.delay_update=!1,o.delay_update?(clearTimeout(o.delay_update_timeout),o.delay_update_timeout=window.setTimeout(()=>{o.delay_update=!1,o.refreshAllRooms()},4e3)):o.refreshAllRooms()},o.refreshAllRooms(),C.V0.events.subscribe(L.B.DeviceUpdate.toString(),o._delay4sUpdate);try{c.a.DefaultController&&(o.list_of_rooms=yield c.a.DefaultController.rooms)}catch(n){console.error(n)}})()}longPressMouseStart(t,o=1,n=1){let r=s=>{this.touchMoving(s)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",s=>{this.pressEndThing(s),document.removeEventListener("mouseup",r),document.removeEventListener("mousemove",r)}),this.longPressStartThing(t,o,n)}longPressStartThing(t,o=1,n=1){t.preventDefault(),this.yScrollDt="mousedown"==t.type?t.pageY:t.changedTouches[0].pageY,this.longPressDetected=!1,this.longPressCounter=window.setTimeout(()=>{this.longPressDetected=!0,this.ChangeVoiceLanguageThing(o,n)},1e3)}touchMoving(t){t.preventDefault(),Math.abs(this.yScrollDt-("mousemove"==t.type?t.pageY:t.changedTouches[0].pageY))>1&&(this.yScrollDt=0,clearTimeout(this.longPressCounter),this.longPressDetected=!1)}pressEndThing(t,o){t.preventDefault(),clearTimeout(this.longPressCounter),this.longPressDetected&&(this.longPressDetected=!1)}ChangeVoiceLanguageThing(t,o=3){let n=c.a.DefaultController.voiceCommandControl.voice_thing_names.filter(s=>s.thing_id==t&&s.language_id==C.V0.defaultVoiceLanguage.id&&-1!=s.id&&s.thing_type==o),r=[],l=c.a.DefaultController.rooms.find(s=>s.id==t);for(let s=0;s<n.length;s++){if(null==n[s])continue;let g=n[s];g.language_id==C.V0.defaultVoiceLanguage.id&&3==g.thing_type&&r.push({id:g.id,command:""==g.command?null:g.command,lang_id:g.language_id})}console.log(l),this.navCtrl.navigateForward(u.OE,{state:{data:{commands:r,thing:l.translated_name,direction:C.V0.defaultVoiceLanguage.direction,ui_direction:this.platform.isRTL?"rtl":"ltr",language_symbol:C.V0.defaultVoiceLanguage.displaySymbol,language_id:C.V0.defaultVoiceLanguage.id,thing_id:l.id,thing_type:3,is_editmode:this.editmode}}})}compare(t,o){return(t=0==t?999999:t)==(o=0==o?999999:o)?0:t<o?-1:1}toggle_editmode(){this.editmode=!this.editmode,this.enable_reorder||(this.reorderSaveState=!1)}toggle_reorder(){this.addedRooms=this.listOfRooms,this.enable_reorder=!this.enable_reorder,this.enable_reorder?(this.editmode=!0,this.reorderSaveState=!0):(this.editmode=!1,this.reorderSaveState=!1)}add_room(){var t=this;return(0,w.Z)(function*(){t.CreateRoom()})()}save_reorder(){var t=this;return(0,w.Z)(function*(){if(c.a.DefaultController.user.is_super_user)(yield t.alertCtrl.create({header:t.translate.instant("sort-order"),cssClass:"network-alert",message:t.translate.instant("sort-order-for"),buttons:[{text:t.translate.instant("only-me"),role:"exit",handler:()=>{for(let r=0;r<t.reorderRoomsIds.length;r++){let l=t.reorderRoomsIds[r],s=t.addedRooms[l.from].sort_order;t.addedRooms[l.from].sort_order=t.addedRooms[l.to].sort_order,t.addedRooms[l.to].sort_order=s}t.reorderRoomsIds=[],t.reorderSaveState=!1,t.editmode=!1,t.enable_reorder=!t.enable_reorder;let n=t.addedRooms.map(r=>r.id);c.a.DefaultController.SetRoomSortOrder(n,!1).then(r=>{t.GetAllRoomsAndResort()})}},{text:t.translate.instant("default"),role:"exit",handler:()=>{for(let r=0;r<t.reorderRoomsIds.length;r++){let l=t.reorderRoomsIds[r],s=t.addedRooms[l.from].sort_order;t.addedRooms[l.from].sort_order=t.addedRooms[l.to].sort_order,t.addedRooms[l.to].sort_order=s}t.reorderRoomsIds=[],t.reorderSaveState=!1,t.editmode=!1,t.enable_reorder=!t.enable_reorder;let n=t.addedRooms.map(r=>r.id);console.log("exiting app"),c.a.DefaultController.SetRoomSortOrder(n,!0).then(r=>{t.GetAllRoomsAndResort()})}},{text:t.translate.instant("cancel"),role:"cancel",handler:()=>{}}],backdropDismiss:!0})).present();else{for(let n=0;n<t.reorderRoomsIds.length;n++){let r=t.reorderRoomsIds[n],l=t.addedRooms[r.from].sort_order;t.addedRooms[r.from].sort_order=t.addedRooms[r.to].sort_order,t.addedRooms[r.to].sort_order=l}t.reorderRoomsIds=[],t.reorderSaveState=!1,t.editmode=!1,t.enable_reorder=!t.enable_reorder;let o=t.addedRooms.map(n=>n.id);c.a.DefaultController.SetRoomSortOrder(o,!1).then(n=>{t.GetAllRoomsAndResort()})}})()}reorderArray(t,o){var n=t[o.from];return t.splice(o.from,1),t.splice(o.to,0,n),t}cancel_reorder(){if(this.reorderSaveState)for(let t=0;t<this.reorderRoomsIds.length;t++){let o=this.reorderRoomsIds[t];this.addedRooms=this.reorderArray(this.addedRooms,{from:o.to,to:o.from})}this.reorderRoomsIds=[],this.reorderSaveState=!1,this.enable_reorder=!1,this.editmode=!1}get_default_order(){var t=this;return(0,w.Z)(function*(){(yield t.alertCtrl.create({header:t.translate.instant("sort-order"),cssClass:"network-alert",message:t.translate.instant("do-you-want-default-sort-order"),buttons:[{text:t.translate.instant("yes"),role:"exit",handler:()=>{console.log("Resorting rooms"),c.a.DefaultController.SetDefaultRoomsSortOrder().then(o=>{console.log("Room Initialied"),t.cancel_reorder(),t.InitializeAllRooms()})}},{text:t.translate.instant("no"),role:"cancel",handler:()=>{t.cancel_reorder()}}]})).present()})()}GetAllRoomsAndResort(){c.a.DefaultController.RefreshRoomsOrder().then(t=>{})}reorderItems(t){console.log(t),this.reorderRoomsIds.push({from:t.from,to:t.to}),this.addedRooms=this.reorderArray(this.addedRooms,t)}showOccupancyDialog(t){var o=this;return(0,w.Z)(function*(){const n=yield o.popoverCtrl.create({component:u.Ow,componentProps:{title:o.translate.instant("occupancy"),room:t,occupancy:t.OccupancyState,forcedOccupancy:t.ForceOccupancyState}});n.onDidDismiss().then(function(){var r=(0,w.Z)(function*(l){if(l&&l.data&&void 0!==l.data.occupancy&&void 0!==l.data.forcedOccupancy){const s=yield o.loadingCtrl.create();yield s.present();try{yield t.setOccupancyState(l.data.occupancy,l.data.forcedOccupancy)}catch{}s.dismiss()}});return function(l){return r.apply(this,arguments)}}()),yield n.present()})()}getItems(t){const o=t.target.value;this.addedRooms=o&&o.length>=2?this.listOfRooms.filter(l=>l.translated_name&&l.translated_name.toLowerCase().indexOf(o.toLowerCase())>-1):this.listOfRooms}moveItemUp(t){let o=this.addedRooms.indexOf(t);0!=o&&this.reorderItems({from:o,to:o-1})}moveItemDown(t){let o=this.addedRooms.indexOf(t);o!=this.addedRooms.length-1&&this.reorderItems({from:o,to:o+1})}toggle_hand(){this.disable_hand=!this.disable_hand}reorderItemsEvent(t){t.detail.complete(),this.reorderItems(t.detail)}selectState(t){this.currentState=t}scrollToSelected(){setTimeout(function(){let t=document.getElementsByClassName("alert-radio-group")[0].querySelector('[aria-checked="true"]');t&&setTimeout(function(){t.scrollIntoView()},400)},5)}ngOnInit(){var t=this;super.ngOnInit(),c.a.DefaultController||this.navCtrl.navigateRoot(u.g6),this.platform.ready().then(()=>{c.a.DefaultController&&(window.scenes=c.a.DefaultController.scenes,window.devices=c.a.DefaultController.devices,window.rooms=c.a.DefaultController.rooms),C.V0.events.subscribe("unauthorized",o=>{console.log("unauthorized"),this.navCtrl.navigateRoot(u.g6)}),this.settings.getValue("showCameraThumbnail").then(o=>{null!=o&&(C.V0.showCameraThumbnail=o)}),this.settings.getValue("shake-enabled").then(o=>{null!=o&&(c.a.ShakeEnabled=o)}),this.settings.getValue("shake-frequency").then(o=>{null!=o&&(c.a.ShakeFrequency=o)}),this.uiLangaugeChangeHandler=o=>{console.log("Language has been changed to: "+o)},C.V0.events.subscribe(G.n.UI_LANGUAGE_CHANGED,this.uiLangaugeChangeHandler)}),null!=c.a.DefaultController&&(0==c.a.DefaultController.isready&&C.V0.events.subscribe(L.B.AllReady,()=>{c.a.DefaultController.isready=!0}),this.settings.getValue("lang").then(o=>{null!=c.a.DefaultController.languages&&(C.V0.uiLanguage=c.a.DefaultController.languages.find(n=>n.symbol==o),null==C.V0.uiLanguage&&(C.V0.uiLanguage=c.a.DefaultController.languages[0]))}),this.navProvider.pagesToLoadFromHome&&new Promise(function(){var o=(0,w.Z)(function*(n){switch(t.navProvider.pagesToLoadFromHome){case"dashboard":let l=-1;if(t.navProvider.name)try{var r=yield c.a.DefaultController.GetDashboards();if(r&&r&&r.body&&r.body.result&&r.body.result.length){let d=r.body.result.find(k=>k.Name.toLowerCase()==t.navProvider.name.toLowerCase());d&&(l=d.Id)}}catch{}-1==l&&(l=t.navProvider.id),-1!=l&&l&&t.navCtrl.navigateForward(u.so,{state:{dashboard_id:l}});break;case"room":let s=-1;if(t.navProvider.name){let d=c.a.DefaultController.rooms.find(k=>k.name.toLowerCase()==t.navProvider.name.toLowerCase());d&&(s=d.id)}(-1==s||t.navProvider.id)&&(s=t.navProvider.id),c.a.DefaultController.rooms.find(d=>d.id==s)?(-1==s&&(s=t.navProvider.id),t.navCtrl.navigateForward(u.Ak,{state:{data:{room:c.a.DefaultController.rooms.find(d=>d.id==s)}}})):t.navCtrl.navigateForward(u.Ak,{state:{data:{room:c.a.DefaultController.rooms.filter(d=>0==d.is_empty)[0],filter:"all"}}})}t.navProvider.pagesToLoadFromHome=void 0});return function(n){return o.apply(this,arguments)}}()))}onInputChange(t,o){this.SaveRoomInformation(o)}onSelectChange(t,o){this.SaveRoomInformation(o)}ShowUILanguages(){var t=this;return(0,w.Z)(function*(){var o=[],n=[];return yield t.settings.getValue("lang").then(function(){var l=(0,w.Z)(function*(s){t.currentLangauge=s,o.push({type:"radio",label:"English",value:"en",checked:"en"==t.currentLangauge}),o.push({type:"radio",label:"\u0639\u0631\u0628\u0649",value:"ar",checked:"ar"==t.currentLangauge}),n.push(t.translate.instant("cancel")),n.push({text:t.translate.instant("ok"),handler:g=>{if(null==g)return;let d=g;t.translate.use(d),t.settings.setValue("lang",d),C.V0.events.publish(G.n.UI_LANGUAGE_CHANGED,d),t.translate.setDefaultLang("ar"==d?"ar":"ur"==d?"ur":"en"),document.documentElement.dir="ar"==d||"ur"==d?"rtl":"ltr"}})});return function(s){return l.apply(this,arguments)}}()),(yield t.alertController.create({cssClass:"network-alert",header:t.translate.instant("select-language"),message:t.translate.instant("select-language-for-ui"),buttons:n,inputs:o})).present().then(()=>{let l=document.getElementsByClassName("alert-radio-group")[0].querySelectorAll("button");document.getElementsByClassName("alert-button-group")[0].querySelectorAll("button")[0].tabIndex=4,document.getElementsByClassName("alert-button-group")[0].querySelectorAll("button")[1].tabIndex=5;for(var s=0;s<l.length;s++)l[s].tabIndex=s}),!1})()}showToast(t){var o=this;return(0,w.Z)(function*(){(yield o.toastController.create({message:t,duration:3e3})).present()})()}openPage(t){var o=this;return(0,w.Z)(function*(){if(console.time("loading"),console.log("open page..."),0==t.isEnabled)return;console.log(t.name);let n="Home2Page",r=!1,l=!1,s=!1;switch(t.type){case"rooms":n=u.WS,r=!0;break;case"lights":case"meters":case"cameras":case"all":case"climate":case"doors":case"curtains":case"sensors":case"media":case"others":n=u.Ak,s=!0;break;case"scenes":n=u.Ak,s=!0,l=!0;break;case"settings":n=u.L6;break;case"speech":n=u.$0;break;case"events":n=u.WX;break;case"help":n=u.Ms;break;case"about":n=u.QS;break;case"arming":n=u._S;break;case"warnings":n=u.QH;break;case"file-manager":n=u.Fw;break;case"sceneCreator":n=u.Cx;break;case"dashboard":n=u.YK;break;case"management":n=u.qx;break;case"ticket":n=u.YF}let g="";s?g=t:r?g="device":l&&(g="scene");let d=yield o.loadingCtrl.create({backdropDismiss:!0});d.present().then(k=>{if(s)if(1==c.a.DefaultController.rooms.filter(P=>0==P.is_empty).length)o.navCtrl.navigateForward(u.Ak,{state:{data:{room:c.a.DefaultController.rooms.filter(P=>0==P.is_empty)[0],filter:t.type,fav:t.fav}}}).then(P=>{console.timeEnd("loading"),d.dismiss()});else{let P=new Z.d;P.id=-1,P.name=o.translate.instant("all"),P.image_url=O.s.Images.main_room,o.navCtrl.navigateForward(n,{state:{data:{room:P,filter:t.type,fav:t.fav}}}).then(T=>{console.timeEnd("loading"),d.dismiss()})}else o.navCtrl.navigateForward(n,{state:{data:g}}).then(P=>{console.timeEnd("loading"),d.dismiss()})}).then(()=>{console.timeEnd("nav-page")})})()}preventBack(){window.history.pushState(null,null,""),window.onpopstate=function(){window.history.go(1)}}openSettingPage(){this.openPage({type:"settings",name:"settings",isEnabled:!0,img:O.s.Images.settings})}openSchedulePage(){this.openPage({type:"scenes",name:"scenes",isEnabled:!0,img:O.s.Images.scene})}openHistoryPage(){this.openPage({type:"events",name:"history",isEnabled:!0,img:O.s.Images.history})}isManagementAllowed(){return c.a.DefaultController&&c.a.DefaultController.user&&c.a.DefaultController.user.is_super_user}openMoreMenu(){let t={type:"management",name:"management",isEnabled:this.isManagementAllowed(),img:O.s.Images.management};this.openPage(t)}}return(a=p).\u0275fac=function(t){return new(t||a)(e.Y36(M.SH),e.Y36(C.V0),e.Y36(M.Br),e.Y36(q.Y),e.Y36(z.sK),e.Y36(M.t4),e.Y36(e.R0b),e.Y36(M.Dh),e.Y36(K.Z),e.Y36(M.yF),e.Y36(M.HT),e.Y36(M.X1),e.Y36(J.F0),e.Y36(e.sBO),e.Y36(M.IN))},a.\u0275cmp=e.Xpm({type:a,selectors:[["home2"]],features:[e.qOj],decls:39,vars:19,consts:[["hideBackButton","true",2,"text-align","center","direction","ltr",3,"ngStyle"],[2,"text-align","end","padding-top","5px","max-width","120px","float","right","min-width","10px"],["class","top-mic-button focusable","tabindex","-1","style","vertical-align:bottom;",3,"touchstart","touchend",4,"ngIf"],[1,"main-logo-col",2,"width","auto","min-width","40px","float","left"],["ion-button","","clear","","class","top-mic-button change-ui-language focusable","tabindex","-1","style","padding: 5px; width:auto; vertical-align: top;",3,"click",4,"ngIf"],["class","top-mic-button focusable","tabindex","-1",3,"id",4,"ngIf"],["component-click","","tabindex","0","tappable","",1,"top-mic-button","back",2,"font-size","30px","text-align","center","vertical-align","middle","display","none",3,"click"],[2,"padding","0px","word-wrap","normal","height","45px","white-space","pre-line"],[2,"padding-top","5px","transform","translateX(-30px)",3,"src"],["style","margin:0;",4,"ngIf"],[2,"--color","var(--my-footer-buttons-color)",3,"ngStyle"],["slot","start"],[1,"footer-button",3,"click"],["name","settings"],["name","calendar"],["name","time"],["slot","end"],[3,"click"],["name","menu"],["tabindex","-1",1,"top-mic-button","focusable",2,"vertical-align","bottom",3,"touchstart","touchend"],["name","mic",1,"voice-mic-button"],[1,"top-badge"],["ion-button","","clear","","tabindex","-1",1,"top-mic-button","change-ui-language","focusable",2,"padding","5px","width","auto","vertical-align","top",3,"click"],[2,"width","30px",3,"src"],["tabindex","-1",1,"top-mic-button","focusable",3,"id"],[2,"margin","0"],[1,"filter-header"],["size","10",4,"ngIf"],["size","2",4,"ngIf"],["size","12",4,"ngIf"],[3,"disabled","ionItemReorder"],["ion-item","",3,"key",4,"ngFor","ngForOf"],["size","10"],["animated","true","debounce","500",2,"width","100%","padding","0px",3,"placeholder","ionInput"],["size","2"],["style","background: transparent;","ion-button","","clear","","class","top-mic-button-bigger",3,"click",4,"ngIf"],["ion-button","","clear","",1,"top-mic-button-bigger",2,"background","transparent",3,"click"],["name","create",2,"font-size","x-large"],["size","12"],[2,"text-align","end","float","right","min-width","10px"],["name","add-circle-outline",2,"font-size","x-large"],["name","code",1,"rotate-90",2,"font-size","x-large"],["name","code-working",1,"rotate-90",2,"font-size","x-large"],["name","checkmark",2,"font-size","x-large"],["name","close",2,"font-size","x-large"],["ion-item","",3,"key"],["id","backgroundImage","class","lite-appflow","ion-item","",3,"style",4,"ngIf"],["id","backgroundImage","ion-item","",1,"lite-appflow"],["backgroundImage",""],[2,"padding","0px"],["class","room-item",3,"click",4,"ngIf"],["class","room-item",4,"ngIf"],["class","floating-icons",4,"ngIf"],[1,"room-toolbar"],["class","status-button",3,"class","active","click",4,"ngIf"],["class","reorder-overlay-clear no-pointer",4,"ngIf"],[1,"room-item",3,"click"],["size","12",2,"padding","0px"],[1,"room-item"],[1,"room-info"],["id","textOverlay",1,"room-name"],["class","room-temperature",4,"ngIf"],[1,"room-temperature"],[2,"width","100%","--background","rgba(0,0,0,.2)","--mybackground-contrast","rgba(0,0,0,.2)"],["type","text","required","",1,"room-name",2,"--background","rgba(0,0,0,.2)","--mybackground-contrast","rgba(0,0,0,.2)","width","100%","margin","auto",3,"ngModel","ngModelChange","ionBlur"],[2,"width","100%","--background","rgba(0,0,0,.2)","--mybackground-contrast","rgba(0,0,0,.2)","background","var(--background)"],["labelPlacement","stacked",1,"room-name",2,"--background","rgba(0,0,0,.2)","--mybackground-contrast","rgba(0,0,0,.2)","margin","auto","width","100%",3,"label","ngModel","click","ngModelChange","ionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[2,"width","100%","--background","rgba(0,0,0,.2)","--mybackground-contrast","rgba(0,0,0,.2)","margin","auto","width","100%"],["slot","start",1,"room-clear-button",2,"z-index","9999","margin","auto","position","absolute","top","100%","left","10px",3,"click"],["slot","end","name","camera"],["slot","start","class","room-clear-button","style","z-index:9999;margin:auto;position: absolute;top: 100%; right:10px",3,"click",4,"ngIf"],["slot","start",1,"room-clear-button",2,"z-index","9999","margin","auto","position","absolute","top","100%","right","10px",3,"click"],["slot","end","name","trash"],[1,"floating-icons"],[1,"icon-container"],[1,"room-device-icon",3,"src"],["id","motion-timer",1,"icon-timer"],["id","door-timer",1,"icon-timer"],[1,"icon-container",2,"pointer-events","all",3,"click"],[1,"room-device-icon",2,"background-size","cover",3,"src"],["id","occupancy-timer",1,"icon-timer"],["id","room-temp",1,"icon-timer"],[1,"status-button",3,"click"],[1,"custom-icon",3,"src"],[1,"reorder-overlay-clear","no-pointer"],["ion-button","","clear","",1,"pointer",2,"position","absolute","top","5px","right","20px","width","10px",3,"click"],["name","chevron-up",2,"color","white","border-top","3px solid"],["ion-button","","clear","",1,"pointer",2,"position","absolute","bottom","5px","right","20px","width","10px",3,"click"],["name","chevron-down",2,"color","white","border-bottom","3px solid"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0),e._UZ(2,"ion-title"),e.TgZ(3,"div")(4,"div",1),e._UZ(5,"connection-warning"),e.YNc(6,W,4,1,"a",2),e.qZA(),e.TgZ(7,"div",3),e.YNc(8,X,2,1,"button",4),e.YNc(9,ee,1,1,"breach-alert",5),e.TgZ(10,"a",6),e.NdJ("click",function(){return o.preventBack()}),e.qZA()(),e.TgZ(11,"div")(12,"ion-title",7),e._UZ(13,"img",8),e.qZA()()()()(),e.YNc(14,ye,11,5,"ion-content",9),e.TgZ(15,"ion-footer")(16,"ion-toolbar",10)(17,"ion-buttons",11)(18,"ion-button",12),e.NdJ("click",function(){return o.openSettingPage()}),e._UZ(19,"ion-icon",13),e.TgZ(20,"ion-label"),e._uU(21),e.ALo(22,"translate"),e.qZA()(),e.TgZ(23,"ion-button",12),e.NdJ("click",function(){return o.openSchedulePage()}),e._UZ(24,"ion-icon",14),e.TgZ(25,"ion-label"),e._uU(26),e.ALo(27,"translate"),e.qZA()(),e.TgZ(28,"ion-button",12),e.NdJ("click",function(){return o.openHistoryPage()}),e._UZ(29,"ion-icon",15),e.TgZ(30,"ion-label"),e._uU(31),e.ALo(32,"translate"),e.qZA()()(),e.TgZ(33,"ion-buttons",16)(34,"ion-button",17),e.NdJ("click",function(){return o.openMoreMenu()}),e._UZ(35,"ion-icon",18),e.TgZ(36,"ion-label"),e._uU(37),e.ALo(38,"translate"),e.qZA()()()()()),2&t&&(e.xp6(1),e.Q6J("ngStyle",o.theAppState.iontoolbarStyle),e.xp6(5),e.Q6J("ngIf",o.platform.is("android")||o.platform.is("ios")),e.xp6(2),e.Q6J("ngIf",!o.hideUILanguage),e.xp6(1),e.Q6J("ngIf",o.getThingBreachStatus),e.xp6(4),e.Q6J("src",o.AppIcon,e.LSH),e.xp6(1),e.Q6J("ngIf",1==o.theAppState.appFlow),e.xp6(2),e.Q6J("ngStyle",o.theAppState.ionfooterStyle),e.xp6(5),e.Oqu(e.lcZ(22,11,"settings")),e.xp6(5),e.Oqu(e.lcZ(27,13,"scenes")),e.xp6(5),e.Oqu(e.lcZ(32,15,"events")),e.xp6(6),e.Oqu(e.lcZ(38,17,"")))},dependencies:[E.sg,E.O5,E.PC,R.JJ,R.Q7,R.On,x.yp,x.YG,x.Sm,x.PM,x.wI,x.W2,x.fr,x.jY,x.Gu,x.gu,x.pK,x.Q$,x.q_,x.Nh,x.oz,x.Nd,x.VI,x.t9,x.n0,x.wd,x.sr,x.QI,x.j9,$.T,j.t,z.X$],styles:[".state-button[_ngcontent-%COMP%]{--background: transparent;font-size:14px}.state-button.active[_ngcontent-%COMP%]{--background: #007bff}.status-button[_ngcontent-%COMP%]{--background: transparent;margin-left:5px}.status-button.active[_ngcontent-%COMP%]{--background: --ion-active-color}.room2-item-icon[_ngcontent-%COMP%]{margin-inline-end:10px;width:80px;position:relative;vertical-align:middle}.device-icon2[_ngcontent-%COMP%], .room2-item-image[_ngcontent-%COMP%]{border:1px solid gray;padding:5px;background-color:#0000001a;border-radius:3px}.room2-item-image[_ngcontent-%COMP%]{width:23vw;height:23vw;margin:auto}.room2-title[_ngcontent-%COMP%]{color:#fff;text-align:center;font-size:xx-large!important;margin:auto!important;width:48vw;overflow:visible;white-space:pre-wrap;text-overflow:ellipsis;word-spacing:normal;display:contents;vertical-align:middle}.room2-detail-grid[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{vertical-align:middle}.room2-item-buttons[_ngcontent-%COMP%]{color:#fff;min-width:20px;text-align:start;height:auto}button.room2-item-buttons[_ngcontent-%COMP%]::part(native){padding:0}.room2-detail-text[_ngcontent-%COMP%]{padding:0 6px;white-space:normal;word-break:normal;text-align:center}.room2-device-icon[_ngcontent-%COMP%]{width:8vw;max-width:64px;font-size:8vw;display:block;vertical-align:middle;margin:auto}.room2-tag[_ngcontent-%COMP%]{color:tomato;font-size:smaller}.room2-forced-occupied[_ngcontent-%COMP%]{-webkit-text-stroke:2px red}.status-button.active[_ngcontent-%COMP%]{--background: #007bff;--color: #fff}._80px[_ngcontent-%COMP%]{margin:0 8px 0 0;width:80px;height:50px;min-height:50px;min-width:50px}._40px[_ngcontent-%COMP%]{width:40px;margin-right:8px;height:40px;min-height:40px;min-width:40px}.room-device-icon[_ngcontent-%COMP%]{max-width:64px;font-size:12px;display:block;vertical-align:middle;margin:auto}.room-detail-text[_ngcontent-%COMP%]{font-size:.8em}.room-item-buttons[_ngcontent-%COMP%]{color:#fff;width:80px;min-width:10px;text-align:center;height:80px}.room-item-buttons[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:inherit}.device-icon[_ngcontent-%COMP%], .room-item-image[_ngcontent-%COMP%]{border:1px solid gray;padding:5px;background-color:#0000001a;border-radius:3px}.room-item-image[_ngcontent-%COMP%]{width:23vw;height:23vw;margin:auto;max-height:80%}.item[_ngcontent-%COMP%], .item-ios[_ngcontent-%COMP%]{background-color:#5353534d;box-shadow:1px 1px 3px #333;border-radius:3px}ion-card[_ngcontent-%COMP%]{background:var(--ion-background)}ion-card[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{background:none}ion-card[_ngcontent-%COMP%]   ion-footer[_ngcontent-%COMP%]{background:transparent;box-shadow:none}ion-item[_ngcontent-%COMP%]{background:var(--ion-background)}.room-title[_ngcontent-%COMP%]{color:var(--ion-text-color);text-align:center;font-size:xx-large!important;margin:auto!important;width:48vw;overflow:visible;white-space:pre-wrap;text-overflow:ellipsis;word-spacing:normal;display:flex;flex-direction:row;vertical-align:middle;white-space:nowrap}.room-item[_ngcontent-%COMP%]{position:relative;width:100%;height:40vw;background-size:cover;background-position:center}.room-image[_ngcontent-%COMP%]{width:100%;height:100%}.room-info[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;justify-content:space-between;padding:10px;background-color:#0000001a}.room-name[_ngcontent-%COMP%]{font-size:5vw;color:#fff!important;text-shadow:3px 3px 5px BLACK}ion-select[_ngcontent-%COMP%]::part(text){font-size:5vw!important;--border-radius: 0px!important}.room-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.transparent-button[_ngcontent-%COMP%]{--background: transparent;--color: #fff}.sensor-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.sensor-row[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:5px}.sensor-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:5px}.sensor-label[_ngcontent-%COMP%]{margin-right:5px}.sensor-value[_ngcontent-%COMP%]{font-weight:700}.state-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:10px}.state-button[_ngcontent-%COMP%]{--background: transparent;--color: #000;font-size:14px}.state-button.active[_ngcontent-%COMP%]{--background: #007bff;--color: #fff}.status-button[_ngcontent-%COMP%]{--background: transparent;--color: #000;margin-left:5px}.status-button.active[_ngcontent-%COMP%]{--background: --ion-active-color;--color: #fff}.room-image[_ngcontent-%COMP%]{width:100%;height:200px}.room-name[_ngcontent-%COMP%]{font-weight:700}.room-temperature[_ngcontent-%COMP%]{font-size:14px;margin-top:5px;color:var(--ion-text-color);text-align:start;color:#fff!important;text-shadow:3px 3px 5px BLACK}.room-card[_ngcontent-%COMP%]{background-size:cover;background-position:center;color:--ion-text-color;height:200px}.room-card[_ngcontent-%COMP%]   .room-info[_ngcontent-%COMP%]{padding:10px}.room-card[_ngcontent-%COMP%]   .room-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px}.room-toolbar[_ngcontent-%COMP%]{--border-style: none;--ion-toolbar-background: rgba(0, 0, 0, .1)}.custom-icon[_ngcontent-%COMP%]{width:48px;height:48px}ion-footer[_ngcontent-%COMP%]{background-color:unset}.floating-icons[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:100}[_ngcontent-%COMP%]:dir(rtl).floating-icons{right:unset;left:10px}.icon-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:10px}.icon-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:--ion-text-color}.icon-label[_ngcontent-%COMP%]{color:var(--ion-text-color);font-size:12px;margin-top:5px}.icon-timer[_ngcontent-%COMP%]{color:var(--ion-text-color);font-size:10px;margin-top:2px}.room-clear-button[_ngcontent-%COMP%]{background:rgba(0,0,0,.2);--background: rgba(0,0,0,.2)}"]}),p})()}];let Pe=(()=>{var a;class p{}return(a=p).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[J.Bz.forChild(ke),J.Bz]}),p})();var Te=f(23934);let Re=(()=>{var a;class p{}return(a=p).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[E.ez,R.u5,x.Pc,Pe,Te.o,z.aw]}),p})()},59764:(Q,Y,f)=>{f.d(Y,{T:()=>w});var E=f(15861),R=f(65879),x=f(56223),J=f(28662);let w=(()=>{var Z;class C{mouseDownEventHandler(h){h.stopImmediatePropagation(),h.preventDefault()}keyEventHandler(h){var y=this;return(0,E.Z)(function*(){if(h.stopImmediatePropagation(),h.preventDefault(),"Enter"==h.key||" "==h.key){var S;let A=null===(S=document.activeElement)||void 0===S?void 0:S.className.toLowerCase();if(A&&(A.indexOf("range-knob-handle")>-1||A.indexOf("range-md")>-1)&&A.indexOf("range-knob-handle")>-1&&(console.log("range-knob-handle"),document.activeElement&&document.activeElement.getAttribute("aria-valuenow"))){let O=document.activeElement.getAttribute("aria-valuenow");if(O){let U=Number.parseFloat(O);if(U||0===U)return console.log("range-knob-handle value change to "+U),void y.model.update.emit(U)}}let c=y.el.nativeElement.nodeName.toLowerCase();const L=yield J.A.getInfo();["button","ion-checkbox","a"].indexOf(c)>-1?"android"!==L.operatingSystem.toLowerCase()&&y.el.nativeElement.click():"!android"!==L.operatingSystem.toLowerCase()&&y.clickOnElement(y.el)}})()}clickOnElement(h){if(document.createEvent){let y=document.createEvent("MouseEvents");y.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),h.nativeElement.dispatchEvent(y)}}mouseDownOnElement(h){let y=new MouseEvent("mousedown",{bubbles:!0,cancelable:!1});h.nativeElement.dispatchEvent(y)}constructor(h,y,S){this.el=h,this.renderer=y,this.model=S,this.eventEmitter=new R.vpe}ngOnInit(){}}return(Z=C).\u0275fac=function(h){return new(h||Z)(R.Y36(R.SBq),R.Y36(R.Qsj),R.Y36(x.On))},Z.\u0275dir=R.lG2({type:Z,selectors:[["","component-click",""]],hostBindings:function(h,y){1&h&&R.NdJ("mousedown",function(A){return y.mouseDownEventHandler(A)})("keypress",function(A){return y.keyEventHandler(A)})},outputs:{eventEmitter:"eventEmitter"},features:[R._Bn([x.On])]}),C})()}}]);