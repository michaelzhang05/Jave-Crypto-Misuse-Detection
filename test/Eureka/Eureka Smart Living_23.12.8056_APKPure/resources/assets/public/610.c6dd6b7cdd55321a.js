"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[610,9764],{60610:(M,y,a)=>{a.r(y),a.d(y,{NotificationPageModule:()=>J});var v=a(96814),d=a(56223),o=a(73582),h=a(70160),_=a(15861),g=a(18024),m=a(8873),E=a(35944),c=a(20416),e=(a(51141),a(65879)),p=a(34414),Z=a(63999),N=a(59764),A=a(48753);function C(l,u){if(1&l&&(e.TgZ(0,"ion-select-option",12),e._uU(1),e.qZA()),2&l){const f=u.$implicit;e.Q6J("value",f.id),e.xp6(1),e.Oqu(f.translated_name)}}function O(l,u){if(1&l&&(e.TgZ(0,"ion-select-option",12),e._uU(1),e.qZA()),2&l){const f=u.$implicit;e.Q6J("value",f),e.xp6(1),e.Oqu(f)}}const D=[{path:"",component:(()=>{var l;class u{constructor(i,t,n,s,T,x){if(this.navCtrl=i,this.toastCtrl=t,this.translate=n,this.modalCtrl=s,this.navParams=T,this.router=x,this.isEditing=!1,this.theAppState=m.a,this.router.getCurrentNavigation().extras.state){const P=this.router.getCurrentNavigation().extras.state;P.data&&(this.navParams.data=P.data,console.log(this.navParams))}else this.navParams.data={};T.data.notification?(T.data.notification&&(this.notification=T.data.notification,this.DeviceChanged()),this.isEditing=!0):(this.notification=new g.u,this.notification.device_property_condition=c.O.Changed,this.notification.notification_type=E.k.Push,this.notification.enabled=1,this.isEditing=!1)}ionViewDidEnter(){console.log("ionViewDidLoad NotificationPage"),m.a.DefaultController&&(this.devices=m.a.DefaultController.devices)}DeviceChanged(){let i=this.notification.device_property;this.notification.device_property=void 0;let t=[],n=m.a.DefaultController.devices.find(s=>s.id==this.notification._device_id);if(n){for(let s of Object.keys(n.properties))s==i&&(this.notification.device_property=i),t.push(s);console.log("device properties",t),this.properties=t}this.properties=t}goBack(){this.navCtrl.back()}Save(){var i=this;return(0,_.Z)(function*(){try{let t,n={deviceNotificationEntity:{deviceId:i.notification._device_id,deviceProperty:i.notification.device_property,devicePropertyCondition:i.notification.device_property_condition,notificationType:i.notification.notification_type,enabled:i.notification.enabled},notificationTemplateEntity:null};i.notification.name&&""!=i.notification.name&&(n.notificationTemplateEntity={content:i.notification.name}),console.log("Saving ",i.notification,n),n.deviceNotificationEntity.enabled=n.deviceNotificationEntity.enabled?1:0,i.isEditing?(n.deviceNotificationEntity.id=i.notification.id,t=yield m.a.DefaultController.EditNotification(i.notification.id,n)):t=yield m.a.DefaultController.CreateNotification(n),i.showToast(i.translate.instant("saved")),i.navCtrl.back()}catch{i.showError(i.translate.instant("error"))}})()}Cancel(){this.goBack()}ShowDeivceSelectionPage(){return(0,_.Z)(function*(){})()}toggleNotification(){this.notification&&(this.notification.enabled=this.notification.enabled?0:1)}showError(i){let t=i;t=i&&i.statusText?i.statusText+" "+(i.status?i.status:""):JSON.stringify(i),this.showToast(t)}showToast(i){var t=this;return(0,_.Z)(function*(){const n=yield t.toastCtrl.create({message:i,duration:3e3,animated:!0,position:"bottom",translucent:!0,buttons:[{side:"end",text:"Close",role:"cancel",handler:()=>{n.dismiss()}}]});yield n.present()})()}compareWith(i,t){return String(i)==String(t)}}return(l=u).\u0275fac=function(i){return new(i||l)(e.Y36(p.SH),e.Y36(p.yF),e.Y36(Z.sK),e.Y36(p.IN),e.Y36(p.X1),e.Y36(h.F0))},l.\u0275cmp=e.Xpm({type:l,selectors:[["notification"]],decls:73,vars:65,consts:[["hideBackButton","true",2,"text-align","center","direction","ltr",3,"ngStyle"],[2,"padding","5px"],[2,"text-align","end","float","right","min-width","10px"],[2,"width","40px","float","left","display","block"],["tappable","","component-click","","tabindex","0",1,"top-mic-button",2,"font-size","30px","text-align","center","vertical-align","middle",3,"click"],["name","chevron-back"],["padding",""],[3,"click"],[2,"pointer-events","none",3,"ngModel","compareWith","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"disabled","ngModel","compareWith","ngModelChange"],[3,"ngModel","compareWith","ngModelChange"],[3,"value"],["disabled","",3,"ngModel","compareWith","ngModelChange"],[1,"item-md",2,"padding-bottom","10px"],[2,"display","inline"],[1,"text-input-md",3,"ngModel","ngModelChange"],[1,"full-primary-button",2,"width","100%",3,"disabled","click"],[1,"full-primary-button",2,"width","100%",3,"click"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"div")(3,"div",1),e._UZ(4,"div",2),e.TgZ(5,"div",3)(6,"a",4),e.NdJ("click",function(){return t.goBack()}),e._UZ(7,"ion-icon",5),e.qZA()(),e.TgZ(8,"div")(9,"ion-title"),e._uU(10),e.ALo(11,"translate"),e.qZA()()()()()(),e.TgZ(12,"ion-content",6)(13,"ion-list")(14,"ion-card")(15,"ion-item",7),e.NdJ("click",function(){return t.ShowDeivceSelectionPage()}),e.TgZ(16,"ion-label"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"ion-select",8),e.NdJ("ngModelChange",function(s){return t.notification.device_id=s})("ngModelChange",function(){return t.DeviceChanged()}),e.YNc(20,C,2,2,"ion-select-option",9),e.qZA()(),e.TgZ(21,"ion-item")(22,"ion-label"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"ion-select",10),e.NdJ("ngModelChange",function(s){return t.notification.device_property=s}),e.YNc(26,O,2,2,"ion-select-option",9),e.qZA()(),e.TgZ(27,"ion-item")(28,"ion-label"),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"ion-select",11),e.NdJ("ngModelChange",function(s){return t.notification.device_property_condition=s}),e.TgZ(32,"ion-select-option",12),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"ion-select-option",12),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"ion-select-option",12),e._uU(39),e.ALo(40,"translate"),e.qZA()()(),e.TgZ(41,"ion-item")(42,"ion-label"),e._uU(43),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"ion-select",13),e.NdJ("ngModelChange",function(s){return t.notification.notification_type=s}),e.TgZ(46,"ion-select-option",12),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"ion-select-option",12),e._uU(50),e.ALo(51,"translate"),e.qZA(),e.TgZ(52,"ion-select-option",12),e._uU(53),e.ALo(54,"translate"),e.qZA()()()()(),e.TgZ(55,"div",14)(56,"ion-label"),e._uU(57),e.ALo(58,"translate"),e.TgZ(59,"p",15),e._uU(60),e.ALo(61,"translate"),e.qZA()(),e.TgZ(62,"ion-textarea",16),e.NdJ("ngModelChange",function(s){return t.notification.name=s}),e.qZA()(),e.TgZ(63,"ion-grid")(64,"ion-row")(65,"ion-col")(66,"ion-button",17),e.NdJ("click",function(){return t.Save()}),e._uU(67),e.ALo(68,"translate"),e.qZA()(),e.TgZ(69,"ion-col")(70,"ion-button",18),e.NdJ("click",function(){return t.Cancel()}),e._uU(71),e.ALo(72,"translate"),e.qZA()()()()()),2&i&&(e.xp6(1),e.Q6J("ngStyle",t.theAppState.iontoolbarStyle),e.xp6(9),e.Oqu(e.lcZ(11,35,"notification")),e.xp6(7),e.Oqu(e.lcZ(18,37,"device")),e.xp6(2),e.Q6J("ngModel",t.notification.device_id)("compareWith",t.compareWith),e.xp6(1),e.Q6J("ngForOf",t.devices),e.xp6(3),e.Oqu(e.lcZ(24,39,"property")),e.xp6(2),e.Q6J("disabled",t.notification.device_id<1)("ngModel",t.notification.device_property)("compareWith",t.compareWith),e.xp6(1),e.Q6J("ngForOf",t.properties),e.xp6(3),e.Oqu(e.lcZ(30,41,"on")),e.xp6(2),e.Q6J("ngModel",t.notification.device_property_condition)("compareWith",t.compareWith),e.xp6(1),e.Q6J("value",1),e.xp6(1),e.Oqu(e.lcZ(34,43,"changed")),e.xp6(2),e.Q6J("value",2),e.xp6(1),e.Oqu(e.lcZ(37,45,"off")),e.xp6(2),e.Q6J("value",3),e.xp6(1),e.Oqu(e.lcZ(40,47,"on")),e.xp6(4),e.Oqu(e.lcZ(44,49,"type")),e.xp6(2),e.Q6J("ngModel",t.notification.notification_type)("compareWith",t.compareWith),e.xp6(1),e.Q6J("value",1),e.xp6(1),e.Oqu(e.lcZ(48,51,"push")),e.xp6(2),e.Q6J("value",2),e.xp6(1),e.Oqu(e.lcZ(51,53,"email")),e.xp6(2),e.Q6J("value",3),e.xp6(1),e.Oqu(e.lcZ(54,55,"sms")),e.xp6(4),e.Oqu(e.lcZ(58,57,"message")),e.xp6(3),e.hij(" \xa0*",e.lcZ(61,59,"optional"),""),e.xp6(2),e.Q6J("ngModel",t.notification.name),e.xp6(4),e.Q6J("disabled",!(t.notification&&t.notification.device_property&&t.notification.device_id)),e.xp6(1),e.Oqu(e.lcZ(68,61,"save")),e.xp6(4),e.Oqu(e.lcZ(72,63,"cancel")))},dependencies:[v.sg,v.PC,d.JJ,d.On,o.YG,o.PM,o.wI,o.W2,o.jY,o.Gu,o.gu,o.Ie,o.Q$,o.q_,o.Nd,o.t9,o.n0,o.g2,o.wd,o.sr,o.QI,o.j9,N.T,A.c,Z.X$]}),u})()}];let b=(()=>{var l;class u{}return(l=u).\u0275fac=function(i){return new(i||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[h.Bz.forChild(D),h.Bz]}),u})();var k=a(23934);let J=(()=>{var l;class u{}return(l=u).\u0275fac=function(i){return new(i||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[v.ez,d.u5,o.Pc,b,Z.aw.forChild(),k.o]}),u})()},59764:(M,y,a)=>{a.d(y,{T:()=>_});var v=a(15861),d=a(65879),o=a(56223),h=a(28662);let _=(()=>{var g;class m{mouseDownEventHandler(c){c.stopImmediatePropagation(),c.preventDefault()}keyEventHandler(c){var r=this;return(0,v.Z)(function*(){if(c.stopImmediatePropagation(),c.preventDefault(),"Enter"==c.key||" "==c.key){var e;let p=null===(e=document.activeElement)||void 0===e?void 0:e.className.toLowerCase();if(p&&(p.indexOf("range-knob-handle")>-1||p.indexOf("range-md")>-1)&&p.indexOf("range-knob-handle")>-1&&(console.log("range-knob-handle"),document.activeElement&&document.activeElement.getAttribute("aria-valuenow"))){let A=document.activeElement.getAttribute("aria-valuenow");if(A){let C=Number.parseFloat(A);if(C||0===C)return console.log("range-knob-handle value change to "+C),void r.model.update.emit(C)}}let Z=r.el.nativeElement.nodeName.toLowerCase();const N=yield h.A.getInfo();["button","ion-checkbox","a"].indexOf(Z)>-1?"android"!==N.operatingSystem.toLowerCase()&&r.el.nativeElement.click():"!android"!==N.operatingSystem.toLowerCase()&&r.clickOnElement(r.el)}})()}clickOnElement(c){if(document.createEvent){let r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),c.nativeElement.dispatchEvent(r)}}mouseDownOnElement(c){let r=new MouseEvent("mousedown",{bubbles:!0,cancelable:!1});c.nativeElement.dispatchEvent(r)}constructor(c,r,e){this.el=c,this.renderer=r,this.model=e,this.eventEmitter=new d.vpe}ngOnInit(){}}return(g=m).\u0275fac=function(c){return new(c||g)(d.Y36(d.SBq),d.Y36(d.Qsj),d.Y36(o.On))},g.\u0275dir=d.lG2({type:g,selectors:[["","component-click",""]],hostBindings:function(c,r){1&c&&d.NdJ("mousedown",function(p){return r.mouseDownEventHandler(p)})("keypress",function(p){return r.keyEventHandler(p)})},outputs:{eventEmitter:"eventEmitter"},features:[d._Bn([o.On])]}),m})()},48753:(M,y,a)=>{a.d(y,{c:()=>d});var v=a(65879);let d=(()=>{var o;class h{constructor(g){this.elementRef=g}ngOnInit(){this.elementRef.nativeElement.classList.add("ion-padding")}}return(o=h).\u0275fac=function(g){return new(g||o)(v.Y36(v.SBq))},o.\u0275dir=v.lG2({type:o,selectors:[["","padding",""]]}),h})()}}]);