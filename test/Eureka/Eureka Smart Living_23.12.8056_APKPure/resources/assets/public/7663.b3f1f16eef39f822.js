"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7663],{77663:(J,Z,f)=>{f.r(Z),f.d(Z,{EventPageModule:()=>ye});var v=f(96814),g=f(56223),p=f(73582),w=f(70160),m=f(15861);class P{constructor(){this.seperate=!1,this.ForceOccupancyState=!1,this.ManualOccupancyState=!1,this.Occupied=!1}}var _=f(77144),M=f(24257),k=f(56450),L=f(90274),D=f(37092),x=f(56544),I=f(20361),S=f(41923),Y=f(79616),C=f(8873),G=f(31138),N=f(19462),E=f(1901),y=f(86845),e=f(65879),F=f(34414),H=f(46729),B=f(63999),Q=f(77935);const K=["pageTop"],$=["searchInput"],j=["datetimepicker"];function W(d,u){if(1&d){const l=e.EpF();e.TgZ(0,"a",46),e.NdJ("touchstart",function(t){e.CHM(l);const r=e.oxw();return e.KtG(r.longPressStart(t))})("touchend",function(){e.CHM(l);const t=e.oxw();return e.KtG(t.PressEnd())}),e._UZ(1,"ion-icon",47),e.TgZ(2,"ion-badge",48),e._uU(3),e.qZA()()}if(2&d){const l=e.oxw();e.xp6(3),e.Oqu(l.speech_language_symbol)}}function X(d,u){if(1&d&&e._UZ(0,"img",49),2&d){const l=e.oxw();e.Q6J("src",null==l.room?null:l.room.image_url,e.LSH)}}function ee(d,u){if(1&d&&(e.TgZ(0,"ion-label",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&d){const l=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,l.filter.name))}}function te(d,u){if(1&d){const l=e.EpF();e.TgZ(0,"ion-datetime",50),e.NdJ("ngModelChange",function(t){e.CHM(l);const r=e.oxw();return e.KtG(r.iso_from_date=t)})("ionChange",function(t){e.CHM(l);const r=e.oxw();return e.KtG(r.onChangeFromPicker(t))}),e._uU(1," >"),e.qZA()}if(2&d){const l=e.oxw();e.Q6J("value",l.iso_from_date)("ngModel",l.iso_from_date)("showDefaultButtons",!0)}}function ie(d,u){if(1&d){const l=e.EpF();e.TgZ(0,"ion-datetime",50),e.NdJ("ngModelChange",function(t){e.CHM(l);const r=e.oxw();return e.KtG(r.iso_to_date=t)})("ionChange",function(t){e.CHM(l);const r=e.oxw();return e.KtG(r.onChangeToPicker(t))}),e.qZA()}if(2&d){const l=e.oxw();e.Q6J("value",l.iso_to_date)("ngModel",l.iso_to_date)("showDefaultButtons",!0)}}function ne(d,u){if(1&d){const l=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",51)(2,"ion-button",52),e.NdJ("click",function(){e.CHM(l);const t=e.oxw();return e.KtG(t.loadBack())}),e._UZ(3,"ion-icon",53),e.qZA()(),e.TgZ(4,"ion-col",54)(5,"span"),e._uU(6),e.qZA()(),e.TgZ(7,"ion-col",55)(8,"ion-button",52),e.NdJ("click",function(){e.CHM(l);const t=e.oxw();return e.KtG(t.loadNext())}),e._UZ(9,"ion-icon",53),e.qZA()()()}if(2&d){const l=e.oxw();e.xp6(2),e.Q6J("disabled",1==l.show_from),e.xp6(1),e.s9C("name",l.prevIconName),e.xp6(3),e.lnq("Page(",l.show_from,"/",l.showing_total_label,") - Total(",l.total_filtered_device_count,")"),e.xp6(2),e.Q6J("disabled",l.showing_total_label==l.show_from),e.xp6(1),e.s9C("name",l.nextIconName)}}function oe(d,u){1&d&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&d&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"no-records-found")))}function ae(d,u){1&d&&e.YNc(0,oe,3,3,"ng-template")}function se(d,u){if(1&d&&(e.TgZ(0,"div",66),e._UZ(1,"img",67),e.qZA()),2&d){const l=e.oxw(3).$implicit;e.xp6(1),e.Q6J("src",l.DeviceImage,e.LSH)}}function re(d,u){if(1&d&&(e.TgZ(0,"div",66)(1,"div",68),e._UZ(2,"img",69),e.qZA()()),2&d){const l=e.oxw(3).$implicit;e.xp6(1),e.Udp("background-color",l.ToValueChanged),e.xp6(1),e.Q6J("src",l.DeviceImage,e.LSH)}}function le(d,u){if(1&d&&(e.YNc(0,se,2,1,"div",60),e.YNc(1,re,3,3,"div",60)),2&d){const l=e.oxw(2).$implicit;e.Q6J("ngIf","RGB"!=l.DeviceType),e.xp6(1),e.Q6J("ngIf","RGB"==l.DeviceType)}}function ce(d,u){if(1&d&&(e.TgZ(0,"div",66),e._UZ(1,"img",70),e.qZA()),2&d){const l=e.oxw(2).$implicit,i=e.oxw();e.xp6(1),e.Udp("background-image",l.ForceOccupancyState?"url("+i.IMAGES.forced_occupancy+")":l.ManualOccupancyState?"url("+i.IMAGES.manual_occupancy+")":""),e.Q6J("src",l.Occupied?i.IMAGES.occupied:i.IMAGES.unoccupied,e.LSH)}}function de(d,u){if(1&d&&(e.TgZ(0,"span",63)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4,"\xa0"),e.TgZ(5,"strong"),e._uU(6),e.ALo(7,"translate"),e.qZA()()),2&d){const l=e.oxw(2).$implicit;e.xp6(1),e.Udp("color",4==l.Type?"green":""),e.xp6(1),e.hij(" ",e.lcZ(3,8,l.ValueName)," "),e.xp6(3),e.Tol(3==l.Type?"room-style":"toText"),e.Udp("color",l.TextColor?l.TextColor:""),e.xp6(1),e.hij(" ",e.lcZ(7,10,l.ToValueChanged)," ")}}function he(d,u){if(1&d&&(e.TgZ(0,"span",63),e._UZ(1,"span",71),e.qZA()),2&d){const l=e.oxw(2).$implicit;e.xp6(1),e.Udp("border",null!=l.ExtraValue?l.ExtraValue:"none")("background-color",l.ToValueChanged)}}function ge(d,u){if(1&d){const l=e.EpF();e.TgZ(0,"div",58),e.NdJ("click",function(){e.CHM(l);const t=e.oxw().$implicit,r=e.oxw();return e.KtG(r.selectItem(t))}),e.YNc(1,le,2,2,"ng-template",59),e.YNc(2,ce,2,3,"div",60),e.TgZ(3,"div",61)(4,"div",62)(5,"span"),e._uU(6),e.qZA(),e.TgZ(7,"span",63),e._uU(8),e.qZA()(),e.TgZ(9,"div",62)(10,"span",64),e._uU(11),e.qZA(),e.YNc(12,de,8,12,"span",65),e.YNc(13,he,2,4,"span",65),e.qZA()()()}if(2&d){const l=e.oxw().$implicit,i=e.oxw();e.Tol("event-item"+(i.selected_id==l.Id?" selected-event":"")),e.xp6(1),e.Q6J("ngIf",l.ThingType!=i.KnownThingTypes.Room),e.xp6(1),e.Q6J("ngIf",l.ThingType==i.KnownThingTypes.Room),e.xp6(4),e.Oqu(l.DeviceName),e.xp6(2),e.Oqu(l.Time),e.xp6(3),e.Oqu(l.RoomName),e.xp6(1),e.Q6J("ngIf","RGB"!=l.DeviceType),e.xp6(1),e.Q6J("ngIf","RGB"==l.DeviceType)}}function pe(d,u){1&d&&e._UZ(0,"div",72)}function fe(d,u){if(1&d&&(e.TgZ(0,"ion-list-header")(1,"ion-label"),e._uU(2),e.qZA(),e._UZ(3,"div",72),e.qZA()),2&d){const l=e.oxw().$implicit;e.xp6(2),e.Oqu(l.date)}}function me(d,u){if(1&d&&(e.TgZ(0,"div"),e.YNc(1,ge,14,9,"div",56),e.YNc(2,pe,1,0,"div",57),e.YNc(3,fe,4,1,"ion-list-header",28),e.qZA()),2&d){const l=u.$implicit;e.xp6(1),e.Q6J("ngIf",1!=l.seperate),e.xp6(1),e.Q6J("ngIf",1!=l.seperate),e.xp6(1),e.Q6J("ngIf",1==l.seperate)}}const _e=[{path:"",component:(()=>{var d;class u extends x.n{constructor(i,t,r,h,s,n,o,c,a,b,O,A,q){if(super(t,o,r,n,i,a,!0,A),this.navCtrl=i,this.api=t,this.alertCtrl=r,this.modalCtrl=h,this.loadingCtrl=s,this.translateService=n,this.platform=o,this.toastController=c,this.popoverCtrl=O,this.router=A,this.pickerController=q,this.KnownThingTypes=E.a,this._data=[],this.itemsRemaining=!1,this.max_to_show=50,this.show_from=1,this.showing_total_label=0,this.total_filtered_device_count=0,this.today="today",this.yesterday="yesterday",this.eventsList=[],this.isRTL=!1,this.nextIconName="caret-forward",this.prevIconName="caret-back",this.selected_room_id=-1,this.groups_count=1,this.listOfRooms=[],this.IMAGES=N.s.Images,this.isMobile=!1,this.isDatePickerOpen=!1,this.theAppState=C.a,this.selected_filter_id=-1,this.serverVersion="",this.seperate_breaker=-1,this.skip=0,this.top=20,this.endPoints="",this.room=null,this.total_remaining=0,this.no_next=!1,this.no_back=!1,this.list_of_devices_to_check=[],this.currentScenes=[],this.showOnlyNotification=!1,this.showOnlyGeneralEvents=!1,this.refresh_timeout_id=-1,this.filterSpecificThing=!1,this.specificThingId=-1,this.specificThingType=-1,this.specificEventType=void 0,this.selected_id=-1,this.search="",this.showSearch=!1,this.isMobile=this.platform.is("mobile"),console.log(Y._.list_of_filters),this.list_of_filters=Object.assign([],Y._.list_of_filters),console.log(this.list_of_filters),this.yesterday=this.translateService.instant("yesterday"),this.today=this.translateService.instant("today"),this.AddingRoomFilter(),this.AddGeneralFilter(),this.AddWarningFilter(),this.AddingNotificationFilter(),this.AddingEveryThingFilter(),!C.a.DefaultController)return;this.listOfRooms=C.a.DefaultController.rooms.filter(T=>T.visible),this.listOfRooms=this.listOfRooms.sort((T,U)=>T.translated_name>U.translated_name?1:U.translated_name>T.translated_name?-1:0),this.listOfRooms.reverse();let V=new L.d;V.id=-1,V.name=this.translate.instant("all"),V.image_url=N.s.Images.main_room,this.listOfRooms.push(V),this.listOfRooms.reverse(),this.room=V,this.filter=this.list_of_filters[0],this.isRTL=this.platform.isRTL,this.nextIconName=this.isRTL?"caret-back":"caret-forward",this.prevIconName=this.isRTL?"caret-forward":"caret-back",this.from_date=new Date;let ve=this.from_date.getTime()-2592e5;this.from_date.setTime(ve);let z=new Date(this.from_date);if(z.setHours(3,0,0),this.BrowserFromPicker=z.toISOString(),this.from_date_label=this.assignDateTime(this.from_date),this.to_date=new Date(Date.now()),this.to_date.setHours(23),this.to_date.setMinutes(59,59,99),this.BrowserToPicker=this.to_date.toISOString(),this.to_date_label=this.assignDateTime(this.to_date),this.iso_from_date=this.from_date.toISOString(),this.iso_to_date=this.to_date.toISOString(),this.router.getCurrentNavigation().extras.state){const T=this.router.getCurrentNavigation().extras.state;T.data?(this.navParams=T.data,console.log(this.navParams)):(console.log("no params"),this.navParams={data:""})}this.DeviceName=this.navParams.DeviceName,this.DeviceType=this.navParams.DeviceType,this.ThingType=this.navParams.ThingType,this.RoomName=this.navParams.RoomName,this.navParams.breached_filter?this.filterCategory(this.list_of_filters[9]):null!=this.DeviceName?(this.search=this.navParams.searchKey,this.search=this.search.toLocaleLowerCase(),Number(this.ThingType)==E.a.Scene?(this.filter=this.list_of_filters.filter(T=>"scene"==T.type)[0],this.room=this.listOfRooms.find(T=>T.name==this.RoomName)):Number(this.ThingType)==E.a.Room?(this.filter=this.list_of_filters.filter(T=>"all"==T.type)[0],this.room=this.listOfRooms.filter(T=>T.name==this.DeviceName)[0]):(this.filter=this.list_of_filters.filter(T=>T.device_types.indexOf(Number(this.DeviceType))>-1)[0],this.room=this.listOfRooms.find(T=>T.name==this.RoomName)),this.filterCategory(this.filter)):this.filterCategory(this.list_of_filters[0]),this.list_of_filters=this.list_of_filters.sort((T,U)=>T.name.toLowerCase()<U.name.toLowerCase()?-1:1),console.log(this.list_of_filters)}get AppIcon(){return window.devicePixelRatio<=1?D.Y.appLogoXSmall:D.Y.appLogo}AddingNotificationFilter(){this.list_of_filters&&!this.list_of_filters.find(i=>"notification"==i.type)&&this.list_of_filters.push(new k.q(10,this.translate.instant("notification"),"notification",!1,N.s.Images.about,[],[],!1,!0,!0,[y.t.Notification]))}AddGeneralFilter(){this.list_of_filters&&!this.list_of_filters.find(i=>"general"==i.type)&&this.list_of_filters.push(new k.q(10,this.translate.instant("general"),"general",!1,N.s.Images.settings,[],[],!1,!0,!0,[y.t.GenericEvent]))}AddingEveryThingFilter(){console.debug("Add EveryThing filter"),this.list_of_filters&&!this.list_of_filters.find(i=>"EveryThing"==i.type)&&this.list_of_filters.unshift(new k.q(-2,this.translate.instant("every-thing"),"Everything",!0,N.s.Images.history,void 0,void 0,void 0,void 0,void 0,[y.t.Action,y.t.ThingPropertyChange,y.t.GenericEvent,y.t.Notification,y.t.Unknown]))}AddingRoomFilter(){console.debug("Add Room filter"),console.log(this.list_of_filters),this.list_of_filters&&!this.list_of_filters.find(i=>"rooms"==i.type)&&this.list_of_filters.push(new k.q(10,this.translate.instant("rooms"),"rooms",!1,N.s.Images.default_room_image,[],[],!1,!0,!0,[y.t.ThingPropertyChange,y.t.Action]))}AddWarningFilter(){console.debug("Adding warning filter"),this.list_of_filters&&!this.list_of_filters.find(i=>"warning"==i.type)&&this.list_of_filters.push(new k.q(10,this.translate.instant("warnings"),"warning",!1,N.s.Images.warning,[],[],!1,!1,!0,[y.t.ThingPropertyChange,y.t.Action]))}showDateTimePicker(){const i=new Date;i.toISOString(),this.from_date=i}updateFromDate(i){this.from_date=i.detail.value}openModal2(){return(0,m.Z)(function*(){console.log("openModal2")})()}onModal2Cancel(){this.datetimepicker.dismiss()}onChangeFromPicker(i){console.log(i.detail,"event.detail"),this.from_date=new Date(i.detail.value),console.log(this.from_date,"this.from_date"),this.from_date_label=this.assignDateTime(this.from_date),this.from_date>this.to_date&&(this.to_date=new Date(this.from_date),this.to_date_label=this.assignDateTime(this.to_date)),this.skip=0,this.show_from=1,this.GetEvents(this.skip,this.top,this.endPoints,this.search),this.datetimepicker.dismiss()}onChangeToPicker(i){this.to_date=new Date(i.detail.value),this.to_date_label=this.assignDateTime(this.to_date),this.from_date>this.to_date&&(this.from_date=this.to_date,this.from_date_label=this.assignDateTime(this.from_date)),this.skip=0,this.show_from=1,this.GetEvents(this.skip,this.top,this.endPoints,this.search),this.datetimepicker.dismiss()}onChangeFromBrowserPicker(i){this.from_date=new Date(this.BrowserFromPicker),this.from_date_label=this.assignDateTime(this.from_date),this.from_date>this.to_date&&(this.to_date=new Date(this.from_date),this.to_date_label=this.assignDateTime(this.to_date)),console.log(this.from_date,"this.from_date "),this.skip=0,this.show_from=1,this.GetEvents(this.skip,this.top,this.endPoints,this.search)}onChangeToBrowserPicker(i){this.to_date=new Date(this.BrowserToPicker),this.to_date_label=this.assignDateTime(this.to_date),this.from_date>this.to_date&&(this.from_date=this.to_date,this.from_date_label=this.assignDateTime(this.from_date)),this.skip=0,this.show_from=1,this.GetEvents(this.skip,this.top,this.endPoints,this.search)}assignDate(i){let t=new Date,r=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate()),h=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),n=Math.floor((h-r)/864e5);return 0==n?this.today+" "+i.toLocaleDateString():1==n?this.yesterday+" "+i.toLocaleDateString():i.toLocaleDateString()}assignDateTime(i){let t=new Date,r=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate()),h=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),n=Math.floor((h-r)/864e5);return 0==n?this.today+" "+i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}):1==n?this.yesterday+" "+i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}):i.toLocaleDateString()+" "+i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}GetKnownDeviceState(i,t="",r=null,h="",s="",n){let o="";if("OfflineReason"==s)return"None"==t?this.translate.instant("online"):`${this.translate.instant("offline")} (${this.translate.instant(t)})`;switch(null!=t&&(t=t.toLowerCase()),i){case _.Y.DoorSensor:o=this.getBooleanValue(t)?"open":"close";break;case _.Y.Lock:o="true"==t?"lock":"unlock";break;case _.Y.MotionSensor:o="true"==t?"active":"idle";break;case _.Y.OccupancySensor:o="true"==t?"occupied":"unoccupied";break;case _.Y.Dimmer:o=0==Number(t)?"off":t+"%";break;case _.Y.Generic:o=t,o=t;break;case _.Y.HumiditySensor:o=t,o=t+"%";break;case _.Y.LightSensor:o=t+"lux";break;case _.Y.RemoteControl:case _.Y.RGB:case _.Y.GenericMeter||_.Y.AcMeter||_.Y.PowerMeter||_.Y.WaterMeter:o=t;break;case _.Y.Shutter:o=Number(t)>=90?"open":Number(t)<=10?"close":Number(t)>0?t+"%":t;break;case _.Y.Switch:o="true"==t?"on":"off";break;case _.Y.TemperatureSensor:o=h.toLowerCase().indexOf("mode")<0?t+(null!=r?r.unit:""):t;break;case _.Y.Thermostat:h.toLowerCase().indexOf("mode")<0?o=n==y.t.Action?"true"==t?"Turn on":"Turn off":"true"==t?"on":Number(t)+"":h.toLowerCase().indexOf("acmode")>-1?o=this.GetAcModeName(t):h.toLowerCase().indexOf("fanmode")>-1&&(o=this.GetFanModeName(t));break;case _.Y.Shutter:o=0==Number(t)?"close":t+"%";break;default:o=t}return o&&o.length>30&&(o=o.substr(0,30)+"..."),o}GetEvents(i,t,r,h){var s=this;return(0,m.Z)(function*(){if(G.B.sslcshowLoading(),s._data=[],s.seperate_breaker=-1,C.a.DefaultController){s.serverVersion=C.a.DefaultController.version;for(let n=0;n<N.s.RetryRequests-1;n++)try{s.serverVersion=s.serverVersion.split(".").join("");let o=new Date;if(o=new Date(s.from_date.setDate(s.from_date.getDate())),parseInt(s.serverVersion)>2111763)yield C.a.DefaultController.getEvents("/odata/EventsData",s.from_date.toISOString(),s.to_date.toISOString(),i,t,r,s.filter.eventFilterType,h).then(c=>{s.total_filtered_device_count=c["@odata.count"],s.showing_total_label=Math.ceil(s.total_filtered_device_count/s.top),c.value&&!c.value.error?(s.eventsList=[],c.value&&c.value.length&&c.value.length>0&&(s._data=c.value),s.applyFilter(),G.B.sslcdismissLoading()):s._data=[]}).catch(c=>{console.log(c)});else{let c=yield C.a.DefaultController.getEventsOld("GetEvents",s.from_date.getFullYear()+"-"+(s.from_date.getMonth()+1)+"-"+s.from_date.getDate()+"T"+("0"+s.from_date.getHours()).slice(-2)+":"+("0"+s.from_date.getMinutes()).slice(-2),s.to_date.getFullYear()+"-"+(s.to_date.getMonth()+1)+"-"+s.to_date.getDate()+"T"+("0"+s.to_date.getHours()).slice(-2)+":"+("0"+s.to_date.getMinutes()).slice(-2));if(c&&!c.error)return s.eventsList=[],c&&c.length&&c.length>0&&(s._data=c),s.applyFilter(),void G.B.sslcdismissLoading()}}catch(o){console.log("Error while receiving events",o)}G.B.sslcdismissLoading(),s._data.length<1&&s.showErrorToast(s.translate.instant("no-data-found"))}})()}filterByRoom(i){this.room=i,this.selected_room_id=i.id,this.filterCategory(this.filter)}resetPager(){this.show_from=0}changeFilterCategory(i){var t=this;return(0,m.Z)(function*(){console.log("changing Filter");const r={component:M.t,componentProps:{list_of_filters:t.list_of_filters},showBackdrop:!0,backdropDismiss:!0},h=yield t.popoverCtrl.create(r);h.onDidDismiss().then(s=>{null!=s.data&&null!=s.data&&(t.resetPager(),t.filterCategory(s.data))}),yield h.present()})()}changeRoom(i){var t=this;return(0,m.Z)(function*(){t.resetPager();let r=[];for(let s=0;s<t.listOfRooms.length;s++){let n=t.listOfRooms[s];r.push({name:n.translated_name,image_url:n.image_url,id:n.id})}const h=yield t.popoverCtrl.create({component:M.t,componentProps:{listofRoomsModel:r},showBackdrop:!0,backdropDismiss:!0});h.onDidDismiss().then(s=>{null!=s.data&&null!=s.data&&t.filterByRoom(s.data)}),yield h.present()})()}loadNext(){var i=this;return(0,m.Z)(function*(){i.skip+=i.top,i.show_from++,i.GetEvents(i.skip,i.top,i.endPoints,i.search),i.pageScrollToTop()})()}loadBack(){var i=this;return(0,m.Z)(function*(){i.show_from--,i.skip>=0&&(i.skip-=i.top),i.skip>-1&&i.GetEvents(i.skip,i.top,i.endPoints,i.search),i.pageScrollToTop()})()}addDateSeperator(i,t){let r=new Date(i);r.getDate()!=this.seperate_breaker&&(this.seperate_breaker=r.getDate(),t.push({seperate:!0,date:this.assignDate(r)}))}applyFilter(i=0,t=-1,r=""){return new Promise(()=>{if(console.log(r?"Filter string provided":"Without filter string"),-1==t&&(t=this.max_to_show),i>t)return void(this.itemsRemaining=!1);this.eventsList=[];let h=[];for(let n=0;n<this._data.length;n++)if(this.specificEventType&&this.specificEventType!=this._data[n].EventType)console.warn("ignored",this.specificEventType);else if(this._data[n].EventType==y.t.ThingPropertyChange||this._data[n].EventType==y.t.Action){if(!this.filter.eventFilterType.includes(this._data[n].EventType))continue;if(this._data[n].ThingType==E.a.Device){if("Power"==this._data[n].Property||"OfflineReason"!=this._data[n].Property&&"warning"==this.filter.type||!this.list_of_devices_to_check||this.list_of_devices_to_check.length<1)continue;let o=this.list_of_devices_to_check.find(a=>a.id==this._data[n].ThingId&&(this.selected_room_id>-1&&this.selected_room_id==a.room_id||this.selected_room_id<0)),c=!1;if(o){if(this.filterSpecificThing&&(!this.filterSpecificThing||this.specificThingId!=o.id||this.specificThingType!=E.a.Device)||null!=this._data[n].Property&&("LastBreached"==this._data[n].Property||"Online"==this._data[n].Property))continue;let a=new P;if(a.visible=!0,a.Type=this._data[n].EventType,a.Type==y.t.Action&&(a.TextColor="rgb(255 165 0)"),a.Id=this._data[n].Id,a.ThingId=o.id,a.ThingType=E.a.Device,a.DeviceName=o.translated_name,a.DeviceImage=o.image_id.getStateImage(this._data[n].PropertyNewValue),a.RoomName=o.room.translated_name,a.CreateBy=this._data[n].CreateBy?this._data[n].CreateBy:"manual",a.Date=new Date(this._data[n].DateTime).toDateString(),a.Time=new Date(this._data[n].DateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),o.type==_.Y.Thermostat)a.ValueName=a.Type!=y.t.Action||y.t.ThingPropertyChange?this._data[n].Property:"",a.FromValueChanged=this.GetKnownDeviceState(o.type,this._data[n].PropertyOldValue,o,a.ValueName,this._data[n].Property,a.Type),a.ToValueChanged=this.GetKnownDeviceState(o.type,this._data[n].PropertyNewValue,o,a.ValueName,this._data[n].Property,a.Type);else if(o.type==_.Y.VirtualDevice){let b=/^UI\.([^.]+)\.Value$/;if(null!=this._data[n].Property&&b.test(this._data[n].Property)){let O=b.exec(this._data[n].Property);if(O.length>1)for(let A=0;A<C.a.DefaultController.device_uis.length;A++){let R=C.a.DefaultController.device_uis[A].controls.find(V=>V.name==O[1]);if(null!=R){a.ValueName=R.getTranslatedText();break}}}else a.ValueName="";a.ToValueChanged=this.getPreciseText(this._data[n].PropertyNewValue,10)}else if(o.type==_.Y.RGB)if(a.DeviceType="RGB","OccupancyState"==this._data[n].Property)a.FromValueChanged=this._data[n].PropertyOldValue,a.ToValueChanged=this._data[n].PropertyNewValue;else{let b=this.getHtmlRgbFromNumber(this.GetKnownDeviceState(o.type,this._data[n].PropertyOldValue,void 0,"","",a.Type)),O=this.getHtmlRgbFromNumber(this.GetKnownDeviceState(o.type,this._data[n].PropertyNewValue,void 0,"","",a.Type));a.FromValueChanged=b[0],a.ToValueChanged=O[0],a.ExtraValue=O[1]}else if(o.type==_.Y.GenericSensor){if(null==this._data[n].Property||"Value"==this._data[n].Property)continue;if("LastValueTime"==this._data[n].Property&&this._data[n].Attributes){let b=JSON.parse(this._data[n].Attributes);b.Value&&((!r||b.Value.toLowerCase().indexOf(r)>-1)&&(c=!0),a.ToValueChanged=`(${b.Value})`)}}else a.DeviceType="A","OfflineReason"==this._data[n].Property&&(a.TextColor="None"==this._data[n].PropertyNewValue?"#32cd32":"#f4cc4c"),this._data[n].PropertyNewValue?this._data[n].PropertyNewValue&&this._data[n].EventType==y.t.Action?(a.ValueName=this._data[n].Property,a.ToValueChanged=this.GetKnownDeviceState(o.type,this._data[n].PropertyNewValue,o,a.ValueName,this._data[n].Property,a.Type)):(a.ValueName=this._data[n].Property,a.FromValueChanged=this.GetKnownDeviceState(o.type,this._data[n].PropertyOldValue,o,a.ValueName,this._data[n].Property,a.Type),a.ToValueChanged=this.GetKnownDeviceState(o.type,this._data[n].PropertyNewValue,o,a.ValueName,this._data[n].Property,a.Type)):a.ToValueChanged=this._data[n].Property;if(this._data[n].Attributes&&"LastUnlocked"==this._data[n].Property){let b=JSON.parse(this._data[n].Attributes);b.LastUnlockedBy&&((!r||b.LastUnlockedBy.toLowerCase().indexOf(r)>-1)&&(c=!0),a.ToValueChanged+=` (${b.LastUnlockedBy})`)}(c||!r||a.DeviceName.toLowerCase().indexOf(r)>-1)&&(this.addDateSeperator(this._data[n].DateTime,h),h.push(a))}}else if(this._data[n].ThingType==E.a.Scene){let o=this.currentScenes.find(c=>c.id==this._data[n].ThingId);if(o){if(this.filterSpecificThing&&(!this.filterSpecificThing||this.specificThingId!=o.id||this.specificThingType!=E.a.Scene))continue;let c=new P;if(c.visible=!0,c.Type=this._data[n].EventType,c.Id=this._data[n].Id,c.Date=new Date(this._data[n].DateTime).toDateString(),c.Time=new Date(this._data[n].DateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),c.DeviceName=o.translated_name,c.RoomName=o.room.translated_name,c.ThingId=o.id,c.ThingType=E.a.Scene,c.DeviceImage=o.image_url,"RunningInstances"==this._data[n].Property){let a=Number(this._data[n].PropertyOldValue),b=Number(this._data[n].PropertyNewValue),O=this.translate.instant("started"),A=this.translate.instant("stopped");c.FromValueChanged=a>0?O:A,c.ToValueChanged=b>0?O:A}else c.ValueName=this._data[n].Property,"False,False,False"!=this._data[n].PropertyNewValue&&(c.ToValueChanged=this._data[n].PropertyNewValue);(!r||c.DeviceName.toLowerCase().indexOf(r)>-1)&&(this.addDateSeperator(this._data[n].DateTime,h),h.push(c))}}else if(this._data[n].ThingType==E.a.Room){if("all"!=this.filter.type&&"Everything"!=this.filter.type&&"rooms"!=this.filter.type||-1!=this.room.id&&this.room.id!=this._data[n].ThingId)continue;let o=this.listOfRooms.find(c=>c.id==this._data[n].ThingId);if(o){if(this.filterSpecificThing&&(!this.filterSpecificThing||this.specificThingId!=o.id||this.specificThingType!=E.a.Room))continue;let c=new P;c.visible=!0,c.Type=this._data[n].EventType,c.Id=this._data[n].Id,c.Date=new Date(this._data[n].DateTime).toDateString(),c.Time=new Date(this._data[n].DateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),c.DeviceName=o.translated_name,c.ThingId=o.id,c.ThingType=E.a.Room,c.DeviceImage=o.image_url;let a="true"==this._data[n].PropertyNewValue.toLowerCase();if("OccupancyState"==this._data[n].Property){if(c.Occupied=a,c.ToValueChanged=a?"occupied":"unoccupied",this._data[n].Attributes){var s=JSON.parse(this._data[n].Attributes);let O=s.ManualOccupancyState;c.ForceOccupancyState="true"==s.ForceOccupancyState.toLowerCase(),c.ManualOccupancyState="true"==O.toLowerCase()}}else c.ValueName=this._data[n].Property,c.ToValueChanged=this._data[n].PropertyNewValue;(!r||c.DeviceName.toLowerCase().indexOf(r)>-1)&&(this.addDateSeperator(this._data[n].DateTime,h),h.push(c))}}}else if(this._data[n].EventType==y.t.Notification||this._data[n].EventType==y.t.Action){if(!this.filter.eventFilterType.includes(this._data[n].EventType))continue;try{if(this.filterSpecificThing&&this.selectedEvent&&this.selectedEvent.Type&&3!=this.selectedEvent.Type)continue}catch{}if(this.filterSpecificThing&&!this.showOnlyNotification||this.filter&&"notification"!=this.filter.type)continue;let o=new P;o.visible=!0,o.Type=this._data[n].EventType,o.Type==y.t.Action&&(o.TextColor="rgb(255 165 0)");let c=this._data[n];if(o.Date=new Date(this._data[n].DateTime).toDateString(),o.Time=new Date(this._data[n].DateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),o.Id=this._data[n].Id,!c.Property){o.DeviceImage=N.s.Images.about,o.DeviceName=this.translate.instant("notification");let a=c.Description;a&&(a.length>40&&(a=a.substring(0,37)+"..."),o.ToValueChanged=a),(!r||o.DeviceName.toLowerCase().indexOf(r)>-1)&&(this.addDateSeperator(this._data[n].DateTime,h),h.push(o))}}else if(this._data[n].EventType==y.t.GenericEvent||this._data[n].EventType==y.t.Action)if("ServiceStarted"==this._data[n].Property){let o=new P;o.visible=!0,o.Type=this._data[n].EventType,o.Type==y.t.Action&&(o.TextColor="rgb(255 165 0)"),o.DeviceName=this.translate.instant(this._data[n].Property),o.Id=this._data[n].Id,o.Date=new Date(this._data[n].DateTime).toDateString(),o.Time=new Date(this._data[n].DateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});let a=JSON.parse(this._data[n].Attributes);a.Version&&(!r||a.Version.toLowerCase().indexOf(r)>-1)&&(o.DeviceImage=this.IMAGES.settings,o.ToValueChanged=`(${a.Version})`,this.addDateSeperator(this._data[n].DateTime,h),h.push(o))}else if("LogIn"==this._data[n].Property){let o=new P;o.visible=!0,o.Type=this._data[n].EventType,o.Type==y.t.Action&&(o.TextColor="rgb(255 165 0)"),o.DeviceImage=this.IMAGES.user_management,o.Id=this._data[n].Id,o.Date=new Date(this._data[n].DateTime).toDateString(),o.Time=new Date(this._data[n].DateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});let c=JSON.parse(this._data[n].Attributes),a=this._data[n].Property;o.DeviceName=a,c.User&&a&&(!r||c.User.toLowerCase().indexOf(r)>-1)&&(o.ToValueChanged=`(${c.User})`,this.addDateSeperator(this._data[n].DateTime,h),h.push(o))}else if(this._data[n].Property){let o=new P;o.visible=!0,o.Type=this._data[n].EventType,o.Type==y.t.Action&&(o.TextColor="rgb(255 165 0)"),o.DeviceImage=this.IMAGES.virtual_device,o.Id=this._data[n].Id,o.Date=new Date(this._data[n].DateTime).toDateString(),o.Time=new Date(this._data[n].DateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),o.DeviceName=this._data[n].Description,(!r||o.DeviceName.toLowerCase().indexOf(r)>-1)&&(this.addDateSeperator(this._data[n].DateTime,h),h.push(o))}for(let n=0;n<h.length;n++)this.eventsList.push(h[n])})}filterCategory(i){this.clearSpecificFilter(),this.selected_filter_id=i.id,this.filter=i;let t=C.a.DefaultController.devices,r=C.a.DefaultController.scenes;this.room.id>-1&&(t=t.filter(a=>a.room_id==this.room.id),r=r.filter(a=>a.room_id==this.room.id));let h=[],s=[],n=[];console.log("filter type:",i),"rooms"==this.filter.type?this.endPoints="%20and%20(ThingType%20in%20["+this.KnownThingTypes.Room+"])":"scene"==this.filter.type?(s=r,n=[],n=s.map(a=>a.id),this.endPoints="%20and%20(ThingType%20in%20["+this.KnownThingTypes.Scene+"])"):"all"==this.filter.type?(h=t.slice(),s=r.slice(),this.endPoints=""):"warning"==this.filter.type?(h=t.slice(),this.endPoints=""):"Everything"==this.filter.type?(h=t.slice(),s=r.slice(),this.endPoints=""):"notification"==this.filter.type?(this.showOnlyNotification=!0,this.endPoints=""):"general"==this.filter.type?(this.showOnlyGeneralEvents=!0,this.endPoints=""):h=this.filter.category.length>0?t.filter(a=>i.category.indexOf(a.category)>-1):t.slice();let o=[];o=i.device_types.length>0?t.filter(a=>i.device_types.indexOf(a.type)>-1):t.slice();let c=[];c=t.filter(i.category_and_type?a=>h.indexOf(a)>-1&&o.indexOf(a)>-1:a=>h.indexOf(a)>-1||o.indexOf(a)>-1),t=i.exclude?t.filter(a=>c.indexOf(a)<0):c,i.exclusionCategoryType&&i.exclusionCategoryType.length>0&&i.exclusionCategoryType.forEach(a=>{t=t.filter(b=>!(b.category==a.deviceCategory&&b.type==a.deviceType))}),"general"!=this.filter.type&&"Everything"!=this.filter.type&&"notification"!=this.filter.type&&"warning"!=this.filter.type&&"rooms"!=this.filter.type&&"scene"!=this.filter.type&&(n=[],n=o.map(a=>a.id),this.endPoints="%20and%20(ThingId%20in%20["+n+"])%20and%20(ThingType%20in%20["+this.KnownThingTypes.Device+"])"),this.list_of_devices_to_check=h,this.currentScenes=s,this.skip=0,this.show_from=1,this.GetEvents(this.skip,this.top,this.endPoints,this.search)}filterCategoryV2(i){this.filter=i,this.selected_filter_id=i.id;let t=C.a.DefaultController.devices,r=[];r=i.category.length>0?t.filter(n=>i.category.indexOf(n.category)>-1):t.slice();let h=[];h=i.device_types.length>0?t.filter(n=>i.device_types.indexOf(n.type)>-1):t.slice();let s=[];s=t.filter(i.category_and_type?n=>r.indexOf(n)>-1&&h.indexOf(n)>-1:n=>r.indexOf(n)>-1||h.indexOf(n)>-1),t=i.exclude?t.filter(n=>s.indexOf(n)<0):s,i.exclusionCategoryType&&i.exclusionCategoryType.length>0&&i.exclusionCategoryType.forEach(n=>{t=t.filter(o=>!(o.category==n.deviceCategory&&o.type==n.deviceType))}),this.list_of_devices_to_check=t,this.applyFilter(0,this.max_to_show)}getHtmlRgbFromNumber(i){let t=0,r=0,h=0,s=0;s=(4278190080&i)>>>24,t=(16711680&i)>>>16,r=(65280&i)>>>8,h=255&i;let o=this.get2DigitNumber((100+s/255*155).toString(16)),c=Math.round(s/255*7)+"px solid #"+o+o+o;return["#"+this.get2DigitNumber(t.toString(16))+this.get2DigitNumber(r.toString(16))+this.get2DigitNumber(h.toString(16)),c]}get2DigitNumber(i){return("0"+i).slice(-2)}ionViewDidEnter(){super.ionViewDidEnter(),console.log("ionViewDidEnter EEventPage"),window.clearTimeout(this.refresh_timeout_id);let i=document.querySelector("ion-datetime>div");i&&(i.innerHTML+='<ion-icon name="calendar" style="color:black;"></ion-icon>')}doRefresh(i){this.GetEvents(this.skip,this.top,this.endPoints,this.search),window.setTimeout(()=>{i.complete()},2e3)}presentLoadingDefault(){return this.loadingCtrl.create({backdropDismiss:!0})}getPreciseText(i,t=10,r="..."){let h=i.length;return!h||h<t+r.length+5?i:i.substr(0,t)+r+i.substr(h-t,h)}getBooleanValue(i){return!("false"==String(i).toLowerCase()||"0"==i||0==i||0==i)}pageScrollToTop(){this.pageTop.scrollToTop()}GetAcModeName(i){switch(i=Number(i)){case S.p.off:return"off";case S.p.heat:return"heat";case S.p.cool:return"cool";case S.p.auto:return"auto";case S.p.dry:return"dry";case S.p.fan:return"fan";default:return"off"}}GetFanModeName(i){switch(i=Number(i)){case I.E.off:return"off";case I.E.auto:return"auto";case I.E.low:return"low";case I.E.medium:return"medium";case I.E.high:return"high";default:return"off"}}clearSpecificFilter(){this.showOnlyNotification=!1,this.showOnlyGeneralEvents=!1,this.filterSpecificThing=!1,this.specificThingId=-1,this.specificThingType=-1,this.specificEventType=void 0,this.selected_id=-1,this.selectedEvent=void 0}selectItem(i){this.selected_id==i.Id?this.selected_id=-1:(this.selectedEvent=i,this.selected_id=i.Id)}toggleThingFilter(i){var t=this;return(0,m.Z)(function*(){t.closeFab(i),t.selectedEvent&&(yield t.alertCtrl.create({cssClass:"network-alert",header:t.translate.instant("filter"),message:(t.selectedEvent.DeviceName?t.selectedEvent.DeviceName:"")+(t.selectedEvent.RoomName?"\nRoom:"+t.selectedEvent.RoomName:""),buttons:[{text:t.translate.instant(t.filterSpecificThing?"clear":"filter"),handler:()=>{t.filterSpecificThing=!t.filterSpecificThing,console.log(t.selectedEvent.DeviceName,t.selectedEvent.ThingId,t.selectedEvent.ThingType,t.filterSpecificThing),t.filterSpecificThing?(t.specificThingId=t.selectedEvent.ThingId,t.specificThingType=t.selectedEvent.ThingType,t.specificEventType=t.selectedEvent.Type,t.search=t.selectedEvent.DeviceName.toLowerCase()):(t.specificThingId=t.specificThingType=-1,t.selectedEvent=void 0,t.specificEventType=void 0,t.selected_id=-1,t.search=""),t.Search()}},{role:"cancel",text:t.translate.instant("cancel")}]})).present()})()}closeFab(i){i.close()}getItems(i){return new Promise(()=>{const t=i.target.value?i.target.value.toLowerCase():void 0;t?this.search=t:this.clearSearch()})}Search(){this.skip=0,this.show_from=1,this.GetEvents(this.skip,this.top,this.endPoints,this.search),this.pageScrollToTop()}clearSearch(){this.searchInput.value="",this.search="",this.GetEvents(this.skip,this.top,this.endPoints,this.search),this.pageScrollToTop()}}return(d=u).\u0275fac=function(i){return new(i||d)(e.Y36(F.SH),e.Y36(H.V0),e.Y36(F.Br),e.Y36(F.IN),e.Y36(F.HT),e.Y36(B.sK),e.Y36(F.t4),e.Y36(F.yF),e.Y36(e.R0b),e.Y36(Q.Z),e.Y36(F.Dh),e.Y36(w.F0),e.Y36(F.up))},d.\u0275cmp=e.Xpm({type:d,selectors:[["page-event"]],viewQuery:function(i,t){if(1&i&&(e.Gf(K,5),e.Gf($,5),e.Gf(j,5)),2&i){let r;e.iGM(r=e.CRH())&&(t.pageTop=r.first),e.iGM(r=e.CRH())&&(t.searchInput=r.first),e.iGM(r=e.CRH())&&(t.datetimepicker=r.first)}},features:[e.qOj],decls:82,vars:28,consts:[["hideBackButton","true",2,"text-align","center","direction","ltr",3,"ngStyle"],[2,"padding","5px"],[2,"text-align","end","float","right","min-width","10px"],["class","top-mic-button","style","vertical-align:bottom;",3,"touchstart","touchend",4,"ngIf"],[2,"width","40px","float","left","display","block"],["tappable","","component-click","","tabindex","0",1,"top-mic-button",2,"font-size","30px","text-align","center","vertical-align","middle",3,"click"],["name","chevron-back"],["ion-button","","tappable","",1,"drop-down-button",2,"width","100%","margin","5px 0px","margin-right","1%",3,"click"],[2,"justify-content","normal","align-items","center"],["size","2","style","width: 32px;","onerror","this.src='assets/img/others/error-icon.png'","class","relative-icon","width","32",3,"src",4,"ngIf"],["size","8",2,"display","flex","flex-direction","row"],[2,"text-overflow","ellipsis","white-space","nowrap","line-height","1.7","font-size","large"],["size","1"],["name","caret-down",2,"font-size","x-large","margin-top","4px"],["tappable","",1,"drop-down-button",2,"text-overflow","ellipsis",";width","100%","margin","5px 0px","margin-right","1%",3,"click"],[2,"width","32px",3,"src"],["style","text-overflow: ellipsis;\n              white-space: nowrap;line-height:1.7;font-size:large;",4,"ngIf"],[1,"small"],["size","6",2,"padding","5px"],["id","open-modalfrom","expand","full","fill","clear","size","small",1,"clear-button","datetime-text",2,"white-space","normal","margin","0","padding","5px"],["name","calendar","slot","start",2,"color","black"],["trigger","open-modalfrom",3,"cssClass"],["datetimepicker",""],["id","open-modalto","expand","full","fill","clear","size","small",1,"clear-button","datetime-text",2,"white-space","normal","margin","0","padding","5px"],["name","calendar",2,"color","black"],["trigger","open-modalto",3,"cssClass"],["datetimepicker2",""],[1,"small",2,"height","55px"],[4,"ngIf"],["padding","","name","pageTop",1,"page-event"],["pageTop",""],["size","10",2,"text-align","start"],["animated","true","debounce","750",2,"padding","0px",3,"placeholder","ionInput","ionClear"],["searchInput",""],["size","2",2,"height","62px"],[1,"drop-down-button",2,"text-align","center","min-height","40px","padding","0","width","100%","height","100%","margin","auto",3,"disabled","click"],["name","search",2,"color","white","font-size","23px"],[4,"ngFor","ngForOf"],["slot","fixed","vertical","bottom","horizontal","end"],["filterfab",""],["size","small",1,"full-primary-button",2,"border-radius","100%"],["name","funnel-outline"],["side","top"],[3,"disabled","click"],["name","add"],["name","close"],[1,"top-mic-button",2,"vertical-align","bottom",3,"touchstart","touchend"],["name","mic",1,"voice-mic-button"],[1,"top-badge"],["size","2","onerror","this.src='assets/img/others/error-icon.png'","width","32",1,"relative-icon",2,"width","32px",3,"src"],["size","cover",3,"value","ngModel","showDefaultButtons","ngModelChange","ionChange"],["size","2",2,"text-align","start"],["ion-button","","tappable","","small","",1,"clear-button",2,"display","inline","margin","auto","margin-top","5px",3,"disabled","click"],[2,"color","black",3,"name"],["size","8","align-self-center","",2,"text-align","center"],["size","2",2,"text-align","end"],[3,"class","click",4,"ngIf"],["class","break-line-grad",4,"ngIf"],[3,"click"],[3,"ngIf"],["class","event-item-start",4,"ngIf"],[1,"event-item-content"],[2,"justify-content","space-between","display","flex"],[2,"text-align","end"],[1,"room-style"],["style","text-align:end;",4,"ngIf"],[1,"event-item-start"],[3,"src"],[1,"event-item-start","rgb-image","image100",2,"-webkit-clip-path","circle(20px at 50% 50%)","clip-path","circle(21px at 50% 50%)","padding","0px","vertical-align","middle"],[2,"width","100%","padding","0px",3,"src"],[1,"room-device-icon",2,"background-size","cover","max-width","32px",3,"src"],[1,"rgb-label-bg",2,"width","30px","height","30px","display","block","border-radius","100%"],[1,"break-line-grad"]],template:function(i,t){if(1&i){const r=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"div")(3,"div",1)(4,"div",2),e._UZ(5,"connection-warning"),e.YNc(6,W,4,1,"a",3),e.qZA(),e.TgZ(7,"div",4)(8,"a",5),e.NdJ("click",function(){return t.goBack()}),e._UZ(9,"ion-icon",6),e.qZA()(),e.TgZ(10,"div")(11,"ion-title"),e._uU(12),e.ALo(13,"translate"),e.qZA()()()()(),e.TgZ(14,"ion-toolbar")(15,"ion-grid")(16,"ion-row")(17,"ion-col")(18,"button",7),e.NdJ("click",function(s){return t.changeRoom(s)}),e.TgZ(19,"ion-row",8),e.YNc(20,X,1,1,"img",9),e._uU(21,"\xa0 "),e.TgZ(22,"ion-col",10)(23,"ion-label",11),e._uU(24),e.ALo(25,"translate"),e.qZA(),e._uU(26," \xa0 "),e.qZA(),e.TgZ(27,"ion-col",12),e._UZ(28,"ion-icon",13),e.qZA()()()(),e.TgZ(29,"ion-col")(30,"button",14),e.NdJ("click",function(s){return t.changeFilterCategory(s)}),e.TgZ(31,"ion-row",8),e._UZ(32,"img",15),e._uU(33,"\xa0 "),e.TgZ(34,"ion-col",10),e.YNc(35,ee,3,3,"ion-label",16),e._uU(36,"\xa0 "),e.qZA(),e.TgZ(37,"ion-col",12),e._UZ(38,"ion-icon",13),e.qZA()()()()()()(),e.TgZ(39,"ion-toolbar",17)(40,"ion-grid")(41,"ion-row")(42,"ion-col",18)(43,"ion-button",19),e._UZ(44,"ion-icon",20),e._uU(45),e.qZA(),e.TgZ(46,"ion-modal",21,22),e.YNc(48,te,2,3,"ng-template"),e.qZA()(),e.TgZ(49,"ion-col",18)(50,"ion-button",23),e._UZ(51,"ion-icon",24),e._uU(52),e.qZA(),e.TgZ(53,"ion-modal",25,26),e.YNc(55,ie,1,3,"ng-template"),e.qZA()()()()(),e.TgZ(56,"ion-toolbar",27)(57,"ion-grid"),e.YNc(58,ne,10,7,"ion-row",28),e.qZA()()(),e.TgZ(59,"ion-content",29,30)(61,"ion-grid")(62,"ion-row")(63,"ion-col",31)(64,"ion-searchbar",32,33),e.NdJ("ionInput",function(s){return t.getItems(s)})("ionClear",function(){return t.clearSearch()}),e.ALo(66,"translate"),e.qZA()(),e.TgZ(67,"ion-col",34)(68,"button",35),e.NdJ("click",function(){return t.Search()}),e._UZ(69,"ion-icon",36),e.qZA()()()(),e.TgZ(70,"ion-list"),e.YNc(71,ae,1,0,null,28),e.YNc(72,me,4,3,"div",37),e.qZA(),e.TgZ(73,"ion-fab",38,39)(75,"ion-fab-button",40),e._UZ(76,"ion-icon",41),e.qZA(),e.TgZ(77,"ion-fab-list",42)(78,"ion-fab-button",43),e.NdJ("click",function(){e.CHM(r);const s=e.MAs(74);return e.KtG(t.toggleThingFilter(s))}),e._UZ(79,"ion-icon",44),e.qZA(),e.TgZ(80,"ion-fab-button",43),e.NdJ("click",function(){e.CHM(r);const s=e.MAs(74);return e.KtG(t.toggleThingFilter(s))}),e._UZ(81,"ion-icon",45),e.qZA()()()()}if(2&i){const r=e.MAs(65);e.xp6(1),e.Q6J("ngStyle",t.theAppState.iontoolbarStyle),e.xp6(5),e.Q6J("ngIf",t.isMobile),e.xp6(6),e.Oqu(e.lcZ(13,22,"history")),e.xp6(8),e.Q6J("ngIf",t.room),e.xp6(4),e.Oqu(e.lcZ(25,24,null==t.room?null:t.room.name)),e.xp6(8),e.Q6J("src",null==t.filter?null:t.filter.image_url,e.LSH),e.xp6(3),e.Q6J("ngIf",t.filter),e.xp6(10),e.hij(" ",t.from_date_label," "),e.xp6(1),e.Q6J("cssClass","center"),e.xp6(6),e.hij(" ",t.to_date_label," "),e.xp6(1),e.Q6J("cssClass","center"),e.xp6(5),e.Q6J("ngIf",t.eventsList.length>0),e.xp6(6),e.s9C("placeholder",e.lcZ(66,26,"search")),e.xp6(4),e.Q6J("disabled",""==r.value),e.xp6(3),e.Q6J("ngIf",!t.eventsList||0==t.eventsList.length),e.xp6(1),e.Q6J("ngForOf",t.eventsList),e.xp6(6),e.Udp("opacity",t.selected_id<0||t.specificThingId>-1?.5:1),e.Q6J("disabled",t.selected_id<0||t.specificThingId>-1),e.xp6(2),e.Udp("opacity",t.filterSpecificThing?1:.5),e.Q6J("disabled",!t.filterSpecificThing)}},dependencies:[v.sg,v.O5,v.PC,g.JJ,g.On,p.yp,p.YG,p.wI,p.W2,p.x4,p.IJ,p.W4,p.zq,p.jY,p.Gu,p.gu,p.Q$,p.q_,p.yh,p.Nd,p.VI,p.wd,p.sr,p.ki,p.QI,p.j9,B.X$],styles:[".card-md[_ngcontent-%COMP%]   .white[_ngcontent-%COMP%]{color:#fff}.list-header-md[_ngcontent-%COMP%]{border:none;margin:8px 0;text-align:center}ion-list-header[_ngcontent-%COMP%]{border:none;margin:8px 0;text-align:center;font-size:large}.toText[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.room-style[_ngcontent-%COMP%]{color:gray}.rgb-label-bg[_ngcontent-%COMP%]{direction:ltr}.event-item[_ngcontent-%COMP%]{padding:3px;margin:1px;display:table;border-collapse:collapse;width:100%}.event-item-content[_ngcontent-%COMP%]{background:rgba(0,0,0,.5);display:table-cell;height:10px;padding:5px;border-left:7px solid rgba(0,0,0,0)}.event-item-start[_ngcontent-%COMP%]{background:rgba(0,0,0,.5);width:60px;display:table-cell;vertical-align:middle;padding:6px;position:relative}.selected-event[_ngcontent-%COMP%]{filter:drop-shadow(2px 4px 6px black);border:2px solid}.grid[_ngcontent-%COMP%]{padding:0}ion-slides[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px}ion-slides[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:small;display:block}.ilabel[_ngcontent-%COMP%]{display:inline}.event-card[_ngcontent-%COMP%]{margin:1px}.datetime-text[_ngcontent-%COMP%]{margin:0!important;min-height:2em!important;height:4em!important;border-radius:2px;font-weight:500;white-space:normal;text-align:center;position:relative;z-index:0;display:inline-block;text-overflow:ellipsis;white-space:nowrap;cursor:pointer}.datetime-md[_ngcontent-%COMP%], .datetime-inner[_ngcontent-%COMP%]{padding:0}.browser[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border:0;background:transparent;text-align:start;margin-top:2px!important}ion-modal.center[_ngcontent-%COMP%]{--width:calc(100% - 2em);align-items:center;--height: auto}ion-modal.center[_ngcontent-%COMP%]   .ion-page[_ngcontent-%COMP%]{position:relative;display:block;contain:content}ion-datetime[_ngcontent-%COMP%]{--background: color(--ion-colors,primary,base);--wheel-fade-background-rgb: none!important;--ion-background-color-rgb: 29,64,105;--ion-text-color: #fff;--ion-text-color-rgb: 255,255,255;--ion-color-step-50: #284a71;--ion-color-step-100: #345378;--ion-color-step-150: #3f5d80;--ion-color-step-200: #4a6687;--ion-color-step-250: #56708f;--ion-color-step-300: #617996;--ion-color-step-350: #6c839e;--ion-color-step-400: #778ca5;--ion-color-step-450: #8396ad;--ion-color-step-500: #8ea0b4;--ion-color-step-550: #99a9bc;--ion-color-step-600: #a5b3c3;--ion-color-step-650: #b0bccb;--ion-color-step-700: #bbc6d2;--ion-color-step-750: #c7cfda;--ion-color-step-800: #d2d9e1;--ion-color-step-850: #dde2e9;--ion-color-step-900: #e8ecf0;--ion-color-step-950: #f4f5f8}ion-datetime[_ngcontent-%COMP%]{--ion-text-color:white!important;--ion-text-color-rgb: white!important;--ion-color-base:skyblue!important;--ion-color-base-rgb:skyblue!important;--ion-color-contrast: red!important;--ion-color-contrast-rgb: red !important;--ion-color-primary-contrast: skyblue!important;--ion-color-primary-contrast-rgb: 255, 255, 255!important;--ion-color-primary-shade:green !important;--ion-color-primary-tint: blue !important;--ion-color-secondary: #3880ff!important}ion-datetime[_ngcontent-%COMP%]::part(wheel-item){--background-color: color(--ion-colors,primary,base)!important}ion-datetime[_ngcontent-%COMP%]{--background: color(--ion-colors,primary,base);--wheel-fade-background-rgb: none!important;--ion-background-color-rgb: 29,64,105;--ion-text-color: #fff;--ion-text-color-rgb: 255,255,255}ion-datetime[_ngcontent-%COMP%]   ion-picker-internal[_ngcontent-%COMP%]{background-color:red!important}.picker-item[_ngcontent-%COMP%]{background-color:green!important}ion-picker-column-internal[_ngcontent-%COMP%]{background:blue!important}ion-datetime[_ngcontent-%COMP%]   ion-picker-column-internal[_ngcontent-%COMP%]{background-color:#00f!important}ion-datetime[_ngcontent-%COMP%]::part(calendar-day){font-size:1.6rem!important}ion-datetime[_ngcontent-%COMP%]::part(month-year-button){font-size:1.6rem!important}ion-datetime[_ngcontent-%COMP%]::part(date-time-text){font-size:1.6rem!important;background-color:red!important}ion-datetime[_ngcontent-%COMP%]::part(native){font-size:1.6rem!important;background-color:red!important}ion-datetime[_ngcontent-%COMP%]::part(date-time){font-size:1.6rem!important;background-color:red!important}ion-datetime[_ngcontent-%COMP%]::part(date-time-column){font-size:1.6rem!important;background-color:red!important}.sc-ion-buttons-md-s[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:not(.button-round){--border-radius: 2px;font-size:1.6rem}.sc-ion-buttons-md-h[_ngcontent-%COMP%]   ion-button#confirm-button[_ngcontent-%COMP%]{font-size:1.6rem}.calendar-days-of-week[_ngcontent-%COMP%]{font-size:1.6rem}.calendar-day.calendar-day-active[_ngcontent-%COMP%]{border:1px solid var(--ion-color-base);background:var(--ion-color-base)}.day-of-week[_ngcontent-%COMP%]{font-size:2rem}ion-label[_ngcontent-%COMP%]{margin:0;display:block;overflow:hidden;flex:1;font-size:inherit;text-overflow:ellipsis;white-space:nowrap}.ion-delegate-host.popover-viewport[_ngcontent-%COMP%]{color:#00f;background-color:#00f}ion-datetime[_ngcontent-%COMP%]{box-shadow:rgba(var(--ion-color-rose-rgb),.3) 0 10px 15px -3px}ion-datetime-picker[_ngcontent-%COMP%]{background-color:red}ion-picker-column[_ngcontent-%COMP%]{background-color:#8a2be2}ion-datetime-buttons[_ngcontent-%COMP%]{background-color:#8a2be2}ion-datetime[_ngcontent-%COMP%]{background:var(--ion-background)}ion-picker-internal.hydrated[_ngcontent-%COMP%]{background:var(--ion-background);--ion-color-step-150: var(--mybackground-contrast-darker);--ion-background-color-rgb: 50,50,50 }ion-datetime[_ngcontent-%COMP%]::part(calendar-day){color:#fff}ion-datetime[_ngcontent-%COMP%]::part(calendar-day   today)[_ngcontent-%COMP%]{color:red}ion-datetime[_ngcontent-%COMP%]::part(calendar-day   disabled)[_ngcontent-%COMP%]{color:gray}"]}),u})()}];let ue=(()=>{var d;class u{}return(d=u).\u0275fac=function(i){return new(i||d)},d.\u0275mod=e.oAB({type:d}),d.\u0275inj=e.cJS({imports:[w.Bz.forChild(_e),w.Bz]}),u})(),ye=(()=>{var d;class u{}return(d=u).\u0275fac=function(i){return new(i||d)},d.\u0275mod=e.oAB({type:d}),d.\u0275inj=e.cJS({imports:[v.ez,g.u5,p.Pc,ue,B.aw.forChild()]}),u})()},56450:(J,Z,f)=>{f.d(Z,{q:()=>p});class v{constructor(m,P,_,M){this.id=m,this.name=P,this.type=_,this.image_url=M}}var g=f(86845);class p extends v{constructor(m,P,_,M=!1,k="",L=[],D=[],x=!0,I=!1,S=!0,Y=[g.t.Unknown],C=[]){super(m,P,_,k),this.category_and_type=!0,this.exclude=!1,this.visible=!0,this.eventFilterType=[g.t.Unknown],this.is_all=M,this.category=L,this.device_types=D,this.category_and_type=x,this.exclude=I,this.visible=S,this.eventFilterType=Y,this.exclusionCategoryType=C}}},79616:(J,Z,f)=>{f.d(Z,{_:()=>k});var v=f(56450),g=f(77144),p=f(9952),w=f(19462),m=f(86845);class P{constructor(D,x){this.deviceCategory=D,this.deviceType=x}}var _=f(1901);class k{static getFilterByType(D){return this.list_of_filters.find(x=>x.type==D)}static getFilterByName(D){return this.list_of_filters.find(x=>x.name==D)}static getFilteredThings(D,x){let I=D;x.exclusionCategoryType&&x.exclusionCategoryType.length>0&&x.exclusionCategoryType.forEach(S=>{I=I.filter(Y=>!(Y.thingType==_.a.Device&&Y.type==S.deviceType&&Y.category==S.deviceCategory))})}}k.list_of_filters=[new v.q(-1,"all","all",!0,w.s.Images.all_device,void 0,void 0,void 0,void 0,void 0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(-3,"rooms","rooms",!1,w.s.Images.default_room_image,[],[],!1,!0,!0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(-2,"scenes","scene",!0,w.s.Images.scene,[],[],!1,!0,!0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(0,"lights","lights",!1,w.s.Images.light._90,[p.I.Lighting],[g.Y.RGB,g.Y.Dimmer,g.Y.Switch],void 0,void 0,void 0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(2,"climate","climate",!1,w.s.Images.climate,[p.I.HVAC,p.I.Fan,p.I.Other],[g.Y.Thermostat,g.Y.Generic],!0,void 0,void 0,[m.t.ThingPropertyChange,m.t.Action],[new P(p.I.Other,g.Y.Switch),new P(p.I.Other,g.Y.Dimmer),new P(p.I.Other,g.Y.Generic)]),new v.q(1,"curtains","curtains",!1,w.s.Images.shutter._50,[p.I.Curtains],[g.Y.Shutter],void 0,void 0,void 0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(3,"sensors","sensors",!1,w.s.Images.sensors,[p.I.Other,p.I.Gate],[g.Y.HumiditySensor,g.Y.TemperatureSensor,g.Y.MotionSensor,g.Y.OccupancySensor,g.Y.EnvironmentSensor,g.Y.DoorSensor,g.Y.GenericSensor,g.Y.FloodSensor,g.Y.SmokeSensor,g.Y.LightSensor],!0,void 0,void 0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(7,"doors","doors",!1,w.s.Images.doors,[p.I.Other,p.I.Gate,p.I.Lock],[g.Y.DoorSensor,g.Y.DoorBell,g.Y.Lock],!0,!1,!0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(5,"media","media",!1,w.s.Images.multi_media_devices,[p.I.Media],[g.Y.MultiMedia],!1,!1,!0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(4,"others","others",!1,w.s.Images.other_devices,[p.I.Siren,p.I.Appliances,p.I.Valve,p.I.Other],[g.Y.Switch,g.Y.Generic,g.Y.VirtualDevice,g.Y.RemoteControl],!0,!1,void 0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(6,"cameras","camera",!1,w.s.Images.camera_devices,[p.I.Other],[g.Y.Camera],!0,!1,!0,[m.t.ThingPropertyChange,m.t.Action]),new v.q(8,"meters","meters",!1,w.s.Images.generic_meter,[p.I.Other],[g.Y.AcMeter,g.Y.GenericMeter,g.Y.WaterMeter,g.Y.PowerMeter],!0,!1,!0,[m.t.ThingPropertyChange,m.t.Action])]},86845:(J,Z,f)=>{f.d(Z,{t:()=>v});var v=function(g){return g[g.Unknown=0]="Unknown",g[g.ThingPropertyChange=1]="ThingPropertyChange",g[g.GenericEvent=2]="GenericEvent",g[g.Notification=3]="Notification",g[g.Action=4]="Action",g}(v||{})}}]);